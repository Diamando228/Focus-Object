<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Focus Object Presentation (EN)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;
      background:#000;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      padding: var(--page-pad);
      overflow:hidden;
    }

    /* Mobile mode: keep 16:9 window centered, allow scroll */
    body.is-mobile{
      overflow:auto;
      align-items:center;
      padding: var(--page-pad);
      min-height: 100vh;
      --window-radius: 18px;
      --pip-size: 136px;
      --pip-radius: 12px;
      --preview-w: 1280px;
      --preview-h: 720px;
      --page-pad: 8px;
      --ui-reserve: calc(var(--ui-gap) + 24px + 10px);
    }

    body.is-mobile .viewport{
      width: min(var(--preview-w), calc(100vw - (2 * var(--page-pad))));
      max-width: var(--preview-w);
      aspect-ratio: 16 / 9;
      height: auto;
      max-height: min(var(--preview-h), calc(96vh - var(--ui-reserve)));
      border-radius: var(--window-radius);
      box-shadow: 0 30px 90px rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.08);
    }

    body.is-mobile .presentation-stage{
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%) scale(var(--scale));
      transform-origin: 50% 50%;
    }

    /* Mobile: readability + layout tuning inside fixed window */
    body.is-mobile .slide{
      padding: 40px 56px 44px 56px;
    }
    body.is-mobile .content-slide{
      padding: 34px 56px 44px 56px;
    }
    body.is-mobile h2{
      font-size: calc(52px * var(--textCompSmall));
    }
    body.is-mobile .pip{
      right: 12px;
      top: 12px;
    }
    body.is-mobile .hero{
      aspect-ratio: 16 / 9;
      min-height: 180px;
      max-height: 220px;
      background: #fff;
    }
    body.is-mobile .proto-layout .hero{
      aspect-ratio: auto;
      min-height: 0;
      max-height: none;
      height: auto;
      flex: 0 0 auto;
    }
    body.is-mobile .proto-layout,
    body.is-mobile .concept-grid,
    body.is-mobile .visual-grid{
      gap: 12px;
      grid-template-columns: 1fr 1fr;
    }
    body.is-mobile .proto-layout{
      grid-template-columns: 1.1fr .9fr;
      align-items: stretch;
    }
    body.is-mobile .proto-layout .panel{
      height: 100%;
    }
    body.is-mobile .slide{
      padding: 28px 40px 32px 40px;
    }
    body.is-mobile .content-slide{
      padding: 24px 40px 32px 40px;
    }
    body.is-mobile .pip-overlay{
      padding: 8px;
      padding-bottom: 42px;
      gap: 6px;
      background:
        radial-gradient(240px 240px at 20% 20%, rgba(212,255,0,.18), rgba(0,0,0,0) 65%),
        linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.55));
      border: 1px solid rgba(255,255,255,.10);
    }
    body.is-mobile .pip-badge{
      padding: 4px 8px;
      font-size: 8px;
      top: 8px;
      left: 8px;
    }
    body.is-mobile .carousel-img{
      object-fit: contain;
      object-position: 50% 50%;
      background: #fff;
    }
    body.is-mobile .proto-layout .carousel-img{
      height: 100%;
      object-fit: cover;
    }
    body.is-mobile .proto-layout .hero{
      aspect-ratio: 16 / 9;
      flex: 1 1 auto;
      min-height: 260px;
      max-height: none;
      margin-top: 6px;
    }
    body.is-mobile .proto-layout .caption{
      margin-top: 4px;
    }
    body.is-mobile .pip-title{ font-size: 12px; }
    body.is-mobile .pip-sub{ font-size: 10px; }
    body.is-mobile .pip-controls.floating{
      left: 8px;
      right: 8px;
      bottom: 4px;
    }
    body.is-mobile .pip-btn{
      padding: 5px 6px;
      font-size: 9px;
      border-radius: 10px;
    }
    body.is-mobile .pip-min{
      width: 24px;
      height: 24px;
    }
    body.is-mobile .pip-min::before{ width: 10px; }
    body.is-mobile .pip-drag-handle{ height: 30px; }
    body.is-mobile #final_pick .pick-layout{
      grid-template-columns: 1fr 1.05fr;
    }
    body.is-mobile #final_pick .pick-grid{
      grid-template-columns: repeat(2, minmax(0,1fr));
    }
    body.is-mobile #final_pick .pick-preview{
      aspect-ratio: 16 / 9;
      width: 100%;
      height: 100%;
      max-height: none;
      min-height: 220px;
      background: #f2f2f2;
    }
    body.is-mobile #final_pick #pickPreviewImg{ object-fit: cover; object-position: 50% 50%; }
    body.is-mobile #slide3 .sub{ margin-top: 18px; }
    body.is-mobile #slide3 .concept-grid{ margin-top: 12px; margin-bottom: 10px; }
    body.is-mobile #slide3 .clist{ gap: 8px; }
    body.is-mobile #slide3 .clist li{ padding: 18px 20px; }
    body.is-mobile #slide3 .analogy{ padding: 14px 18px 16px; margin-top: 12px; }
    body.is-mobile #final_pick .pick-panel{ grid-template-rows: auto auto minmax(220px, 1fr) auto; }
    body.is-mobile #final_pick .pick-preview{ margin-bottom: 8px; }
    body.is-mobile #final_pick .pick-actions{ margin-top: 8px; max-height: 120px; overflow: auto; }
    body.is-mobile #final_pick .pick-text{ height: 86px; min-height: 86px; }
    body.is-mobile #slide1 .timer-icon{
      width: 560px;
      height: 560px;
      right: -180px;
      top: 52%;
      opacity: 1;
    }
    body.is-mobile #slide1 .header{
      position: relative;
    }
    body.is-mobile #slide1 .nav{
      position: absolute;
      right: 16px;
      top: 10px;
      font-size: 18px;
      gap: 30px;
    }

    :root{
      --stage-w: 1920;
      --stage-h: 1080;
      --scale: 1;
      --textCompSmall: 1;
      --preview-w: 1100px;
      --preview-h: 618px; /* 16:9 */
      --page-pad: 24px;

      --window-radius: 32px;

      --ui-gap: clamp(10px, 2vh, 22px);
      --scrub-pad-y: 6px;
      --scrub-pad-x: 8px;
      --scrub-w: clamp(220px, 34vw, 360px);
      --ui-reserve: calc(var(--ui-gap) + 34px + 14px);
      --timerScale: 1.55;
    }

    /* viewport responsive full-screen preview */
    .viewport{
      /* fixed-like preview feel */
      width: min(var(--preview-w), calc(100vw - (2 * var(--page-pad))));
      max-width: var(--preview-w);

      aspect-ratio: 16 / 9;
      height: auto;

      /* don't exceed screen height */
      max-height: min(var(--preview-h), calc(92vh - var(--ui-reserve)));

      position: relative;
      background: #000;

      border-radius: var(--window-radius);
      overflow: hidden;

      box-shadow: 0 30px 90px rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.08);
    }

    /* 1920√ó1080 stage scales via --scale */
    .presentation-stage{
      width: calc(var(--stage-w) * 1px);
      height: calc(var(--stage-h) * 1px);

      position: absolute;
      left: 50%;
      top: 50%;

      transform: translate(-50%, -50%) scale(var(--scale));
      transform-origin: 50% 50%; /* ‚úÖ –û–¶–ï –í–ê–ñ–õ–ò–í–û */

      will-change: transform;
    }

    #deck{
      border-radius: var(--window-radius);
      overflow: hidden;
    }

    /* keep old #prototypesMount */
    #prototypesMount{display:contents}

    .slide{background:#f5f5f5;width:100%;height:100%;border-radius:0;padding:56px 76px 56px 76px;position:relative;overflow:hidden;display:none;flex-direction:column;opacity:1;transition:opacity 240ms ease}
    .slide.active{display:flex}

    .content-slide{padding:42px 76px 54px 76px}
    .slide-number{--fs:18px;font-weight:700;color:#999;margin-bottom:16px;letter-spacing:2px}
    h2{font-size: 52px;font-weight:800;color:#000;margin-bottom:8px;letter-spacing:-1.5px;line-height:1.03}
    .sub{--fs:14px;line-height:1.55;color:#333;margin-top:6px}

    .image-only-slide{padding:0;background:#0b0b0b}
    .image-only-slide.active{display:block}
    .full-bleed-img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;object-position:var(--crop-x, 50%) var(--crop-y, 50%);display:block;z-index:1}

    .img-missing{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;padding:18px;background:radial-gradient(1200px 700px at 20% 20%, rgba(212,255,0,.12), rgba(0,0,0,0) 55%), #0b0b0b;color:#fff;text-align:center;z-index:2}
    .img-missing .tag{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.14);font-size:11px;font-weight:800;letter-spacing:.12em;text-transform:uppercase}
    .img-missing .hint{max-width:80%;font-size:12px;line-height:1.45;color:rgba(255,255,255,.75);word-break:break-word}
    .img-missing code{display:block;margin-top:6px;color:#d4ff00;background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.12);padding:10px 12px;border-radius:12px;max-width:90%;white-space:pre-wrap;word-break:break-word}

    .header{display:flex;justify-content:space-between;align-items:flex-start}
    .title-section h1{font-size: 120px;font-weight:700;letter-spacing:-3px;line-height:.95;color:#000}
    .title-section .tm{font-size: 48px;vertical-align:super;font-weight:400}
    .nav{display:flex;gap:30px;--fs:13px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}
    .nav-item{color:#666;cursor:pointer;transition:color .3s}
    .nav-item.active{background:#d4ff00;color:#000;padding:4px 12px;border-radius:4px}
    .year-badge{background:#d4ff00;color:#000;font-size: 36px;font-weight:700;padding:8px 20px;border-radius:6px;display:inline-block;margin-top:16px}
    .description{
      max-width: 580px;
      margin-top: 22px;
      padding-left: 14px;
      border-left: 3px solid rgba(0,0,0,.08);
    }
    .description p{
      --fs: 13.5px;
      line-height: 1.75;
      color: #1a1a1a;
      margin-bottom: 14px;
      font-weight: 420;
    }

    /* keep rhythm between paragraphs */
    .description p + p{
      margin-top: 10px;
    }

    /* if inline margin-top remains in HTML ‚Äî normalize it */
    .description p[style*="margin-top"]{
      margin-top: 10px !important;
    }

    /* hero slide typography overrides */
    #slide1 .title-section h1{
      font-size: calc(120px * var(--hero-comp));
      letter-spacing: -3px;
      line-height: .95;
      font-weight: 700;
    }
    #slide1 .title-section .tm{
      font-size: calc(48px * var(--hero-comp));
      vertical-align: super;
      font-weight: 400;
    }
    #slide1 .nav{
      gap: 30px;
      font-size: calc(13px * var(--hero-comp));
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: .5px;
    }
    #slide1 .year-badge{
      background: #d4ff00;
      color: #000;
      font-size: calc(36px * var(--hero-comp));
      font-weight: 700;
      padding: calc(8px * var(--hero-comp)) calc(20px * var(--hero-comp));
      border-radius: calc(6px * var(--hero-comp));
      display: inline-block;
      margin-top: 16px;
    }
    #slide1 .description{
      margin-top: 18px;
      padding-left: 0;
      border-left: none;
    }

    .timer-icon{width:560px;height:560px;position:absolute;right:-120px;top:50%;transform:translateY(-50%) scale(var(--timerScale));transform-origin:center}
    .timer-circle{width:100%;height:100%;border:40px solid #e0e0e0;border-radius:50%;position:relative;box-shadow:0 20px 60px rgba(0,0,0,.1)}
    .timer-hand{position:absolute;width:8px;height:180px;background:#000;left:50%;top:50%;transform-origin:center top;transform:translateX(-50%) translateY(0);border-radius:4px;animation:rotate 2s ease-in-out infinite}
    .timer-center{position:absolute;width:60px;height:60px;background:#d4ff00;border-radius:50%;left:50%;top:50%;transform:translate(-50%,-50%);box-shadow:0 4px 12px rgba(212,255,0,.4)}
    @keyframes rotate{0%,100%{transform:translateX(-50%) translateY(0) rotate(0deg)}50%{transform:translateX(-50%) translateY(0) rotate(180deg)}}

    .visual-grid{margin-top:14px;display:grid;grid-template-columns:1fr 1fr;gap:18px;align-items:stretch;flex:1;min-height:0}
    .visual-column{position:relative;border-radius:18px;padding:11px;display:flex;flex-direction:column;gap:10px;overflow:hidden;min-height:0}
    .visual-column.noisy{background:#ededed;border:1px solid rgba(0,0,0,.06)}
    .visual-column.calm{background:#f7f9e6;border:1px solid rgba(0,0,0,.08)}
    .visual-label{--fs:11px;font-weight:800;letter-spacing:.12em;text-transform:uppercase;color:rgba(0,0,0,.55);user-select:none}

    .visual-collage{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;align-content:start;flex:0 0 auto}
    .tile{width:100%;aspect-ratio:1/1;border-radius:12px;overflow:hidden;background:#ddd;position:relative}
    .thumb{width:100%;height:100%;object-fit:cover;display:block}

    .visual-notes{margin:6px 0 0 0;padding:0;list-style:none;display:grid;gap:6px;flex:0 0 auto}
    .visual-notes li{padding:8px 10px;border-radius:12px;background:rgba(0,0,0,.03);border:1px solid rgba(0,0,0,.06);--fs:11.75px;line-height:1.32;color:#111}

    .concept-grid{margin-top:16px;display:grid;grid-template-columns:1fr 1fr;gap:16px;align-items:stretch}
    .card{background:#fff;border:1px solid rgba(0,0,0,.10);border-radius:18px;padding:18px;box-shadow:0 18px 50px rgba(0,0,0,.06);position:relative;overflow:hidden;display:flex;flex-direction:column}
    .card.accent::before{content:"";position:absolute;inset:0;border-radius:18px;pointer-events:none;background:linear-gradient(135deg,rgba(212,255,0,.28),rgba(212,255,0,0) 55%)}
    .kicker{--fs:11px;font-weight:800;letter-spacing:.12em;text-transform:uppercase;color:rgba(0,0,0,.45);position:relative;z-index:1}
    .ctitle{margin-top:8px;--fs:18px;font-weight:800;letter-spacing:-.02em;color:#000;position:relative;z-index:1}
    .clist{list-style:none;margin-top:12px;display:grid;gap:10px;position:relative;z-index:1}
    .clist li{display:grid;grid-template-columns:130px 1fr;gap:10px;padding:10px;border-radius:12px;background:rgba(0,0,0,.03)}
    .clist .label{--fs:12px;font-weight:700;color:rgba(0,0,0,.60)}
    .clist .value{--fs:12.5px;line-height:1.5;color:#111}

    .analogy{
      margin-top:12px;
      border-radius:16px;
      padding:12px 16px;
      background:#f0f0f0;
      border:1px solid rgba(0,0,0,.08);
    }

    #slide3 .atag{
      display: inline-flex;      /* –∞–±–æ inline-block */
      width: fit-content;
      align-self: flex-start;    /* —â–æ–± —É flex-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ –Ω–µ —Ç—è–≥–Ω—É–ª–æ */
      font-size: calc(13px * var(--textCompSmall)); /* üëà –ö–†–£–¢–ò –¢–£–¢ */
      font-weight:800;
      letter-spacing:.12em;
      text-transform:uppercase;
      background:#d4ff00;
      color:#000;
      padding:8px 14px;       /* üëà –º–æ–∂–Ω–∞ —Ç–µ–∂ —Ç—Ä–æ—Ö–∏ –∫—Ä—É—Ç–∏—Ç–∏ */
      border-radius:999px;
    }

    .analogy p{
      margin-top:8px;
      --fs:14px;
      line-height:1.5;
      color:#111;
    }

    /* === Slide 03 (fill cards nicely) === */
    /* Slide 03 ‚Äî do not touch display, controlled by .slide/.active */
    #slide3{
      flex-direction: column;
      min-height: 100%;
    }

    #slide3.active{
      flex-direction: column;
      min-height: 100%;
    }

    #slide3 .concept-grid{
      flex: 1 1 auto;
      min-height: 0;
    }

    /* cards are already flex, but keep safe */
    #slide3 .card{
      min-height: 0;
    }

    /* ‚úÖ main: list takes all remaining space */
    #slide3 .clist{
      flex: 1 1 auto;
      min-height: 0;
      display: flex;          /* –∑–∞–º—ñ–Ω—è—î–º–æ grid ‚Üí flex */
      flex-direction: column;
      gap: 10px;
    }

    /* === Slide 03: typography + spacing polish === */
    #slide3{
      /* controlled spacing between blocks inside slide */
      --s3-gap: 16px;
      --s3-row-pad: 28px;     /* ‚Äú–º‚Äô—è—Å–æ‚Äù —Ä—è–¥–∫–∞ */
      --s3-label-fs: 14px;    /* label bigger */
      --s3-value-fs: 15.5px;  /* value bigger */
    }

    /* slightly less gap after subtitle to fit nicely */
    #slide3 .sub{ margin-top: 26px; }

    /* grid + why lofi need proper spacing */
    #slide3 .concept-grid{
      margin-top: 16px;
      margin-bottom: var(--s3-gap);
    }

    #slide3 .analogy{
      margin-top: 16px;
      padding: 18px 22px 20px;   /* ‚¨ÖÔ∏è –≥–æ–ª–æ–≤–Ω–µ */
      border-radius: 18px;
      border:1px solid rgba(0,0,0,.08);

      display: flex;
      flex-direction: column;
      gap: 10px;                /* ‚¨ÖÔ∏è —Ä–∏—Ç–º –º—ñ–∂ WHY —ñ —Ç–µ–∫—Å—Ç–æ–º */
    }

    /* richer rows with controlled padding */
    #slide3 .clist li{
      padding: var(--s3-row-pad);
    }

    /* increase typography in slide3, regardless of global --fs */
    #slide3 .clist .label{
      font-size: calc(var(--s3-label-fs) * var(--textCompSmall));
      line-height: 1.15;
    }
    #slide3 .clist .value{
      font-size: calc(var(--s3-value-fs) * var(--textCompSmall));
      line-height: 1.35;
    }

    /* === Slide 02: typography + spacing polish (like slide3) === */
    #slide2{
      --s2-label-fs: 12px;
      --s2-note-fs: 14px;
      --s2-sub-fs: 15px;

      /* a bit more breathing room */
      --s2-col-pad: 14px;
      --s2-col-gap: 12px;
      --s2-grid-gap: 22px;

      /* make rows more ‚Äúmeaty‚Äù */
      --s2-row-pad-y: 14px;   /* –±—É–ª–æ ~12 */
      --s2-row-pad-x: 16px;
    }

    /* headline slightly bigger */
    #slide2 h2{
      font-size: calc(54px * var(--textCompSmall));
    }

    /* subtitle bigger and more readable */
    #slide2 .sub{
      --fs: var(--s2-sub-fs);
      line-height: 1.55;
      margin-top: 8px;
    }

    /* columns ‚Äî more padding and rhythm */
    #slide2 .visual-grid{
      gap: var(--s2-grid-gap);
    }

    #slide2 .visual-column{
      padding: var(--s2-col-pad);
      gap: var(--s2-col-gap);
    }

    /* labels ALREADY EXISTS / DIRECTION */
    #slide2 .visual-label{
      --fs: var(--s2-label-fs);
      letter-spacing: .14em;
    }

    /* notes ‚Äî larger type + more padding */
    #slide2 .visual-notes{
      gap: 8px;
    }

    #slide2 .visual-notes li{
      --fs: var(--s2-note-fs);
      line-height: 1.38;
      padding: 12px 14px;
      border-radius: 14px;
    }

    /* rows */
    #slide2 .visual-notes li{
      padding: var(--s2-row-pad-y) var(--s2-row-pad-x);
      font-size: calc(var(--s2-note-fs) * var(--textCompSmall));
      line-height: 1.4;
    }

    /* list takes more vertical space */
    #slide2 .visual-notes{
      gap: 10px; /* –±—É–ª–æ 8 */
    }

    /* WHY LOFI down */


    :root{ --mutedGrey: rgba(0,0,0,.28); }

    .flow-card{margin-top:18px;flex:1;min-height:0;background:#fff;border:1px solid rgba(0,0,0,.10);border-radius:28px;padding:48px 60px 60px;box-shadow:0 18px 50px rgba(0,0,0,.06);position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:center}
    .flow-grid{display:grid;grid-template-columns:minmax(0,1.05fr) 64px minmax(0,1fr);grid-template-rows:auto auto;column-gap:56px;row-gap:48px;align-items:center;align-content:center;flex:1 1 auto;min-height:520px}
    .flow-left,.flow-right{padding:0;display:flex;align-items:flex-start;justify-content:flex-start}
    .flow-left{flex-direction:column;justify-self:center;width:fit-content}
    .flow-left--center{align-items:center;text-align:center}
    .flow-title{font-size:calc(90px * var(--textCompSmall));font-weight:800;letter-spacing:-.06em;line-height:.9;color:#111;text-align:left;max-width:500px}
    .flow-title--stacked{text-align:center;max-width:none}
    .flow-title--stacked span{display:block}
    .flow-label{font-size:calc(42px * var(--textCompSmall));font-weight:700;letter-spacing:-.04em;line-height:1;color:var(--mutedGrey);text-align:left;max-width:420px;margin-top:40px}
    .flow-copy{max-width:540px;--fs:17px;line-height:1.7;color:#111;font-size:calc(var(--fs) * var(--textCompSmall))}
    .flow-copy strong{font-weight:800}
    .flow-copy.muted{color:var(--mutedGrey);margin-top:32px}
    .flow-mid{grid-column:2;grid-row:1/span 2;position:relative;height:100%;min-height:420px;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:18px 0}
    .flow-line{position:absolute;left:50%;top:0;bottom:0;width:3.5px;transform:translateX(-50%);border-radius:999px;background:rgba(0,0,0,.22);overflow:hidden}
    .flow-line::before{content:"";position:absolute;left:0;top:0;width:100%;height:52%;background:#d4ff00;border-radius:999px;transform-origin:top;transform:scaleY(1)}
    #slide4.animate-line .flow-line::before{transform:scaleY(0);animation:fillToMid 2000ms cubic-bezier(.2,.8,.2,1) forwards}
    @keyframes fillToMid{to{transform:scaleY(1)}}
    .flow-dot{position:relative;width:18px;height:18px;border-radius:999px;background:#fff;border:2px solid rgba(0,0,0,.55);z-index:2}
    .flow-dot.active{background:#d4ff00;border-color:rgba(0,0,0,.75);box-shadow:0 12px 32px rgba(212,255,0,.45)}
    .flow-dot.bottom{opacity:.35}
    .flow-foot{display:none}

     /* =========================
       SLIDE 04 ‚Äî FILL HEIGHT (fixed)
       ========================= */

    /* card should fill remaining slide height */
    #slide4 .flow-card{
      flex: 1 1 auto;
      min-height: 0;
      justify-content: stretch;
    }

    /* SLIDE 04 ‚Äî spacing control (top + bottom) */
    #slide4{
      --s4-row-gap: 14px;        /* –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ —Ä—è–¥–∞–º–∏ */
      --s4-pad-top: 62px;        /* üëà –æ–ø—É—Å–∫–∞—î –≤–µ—Ä—Ö */
      --s4-pad-bottom: 38px;     /* üëà –æ–ø—É—Å–∫–∞—î –Ω–∏–∑ */
      --s4-row2: 440px;          /* üëà —Ä–æ–±–∏—Ç—å –Ω–∏–∂–Ω—ñ–π —Ç—Ä–µ–∫ ‚Äú–≥–ª–∏–±—à–∏–º‚Äù, —â–æ–± –±–ª–æ–∫ –º—ñ–≥ —Å—ñ—Å—Ç–∏ –Ω–∏–∂—á–µ */
    }

    #slide4 .flow-grid{
      grid-template-columns: minmax(0, .92fr) 64px minmax(0, 1.28fr);
      grid-template-rows: auto minmax(0, var(--s4-row2));

      height: 100%;
      min-height: 0;

      column-gap: 44px;
      row-gap: var(--s4-row-gap);

      padding-top: var(--s4-pad-top);
      padding-bottom: var(--s4-pad-bottom);

      align-content: stretch;
      align-items: start;
    }

    /* ‚úÖ second row sticks to bottom of its track */
    #slide4 .flow-left[style*="grid-row:2"],
    #slide4 .flow-right[style*="grid-row:2"]{
      align-self: end;
    }

    /* vertical line spans full height */
    #slide4 .flow-mid{
      grid-row: 1 / span 2;
      align-self: stretch;
      height: auto;
      min-height: 0;
      padding: 0;
    }

    #slide4 .flow-line{
      top: 0;
      bottom: 0;
    }


    /* right blocks can use full column width */
    #slide4 .flow-right{
      justify-self: stretch;
      align-self: flex-start;
    }

    /* MAIN TEXT */
    #slide4 .flow-copy:not(.muted){
      max-width: none;
      width: 100%;
      font-size: calc(15px * var(--textCompSmall));
      line-height: 1.72;
      color: rgba(0,0,0,.78);
    }

    /* MUTED TEXT (secondary) */
    #slide4 .flow-copy.muted{
      max-width: none;
      width: 100%;
      font-size: calc(14px * var(--textCompSmall));
      line-height: 1.68;
      color: rgba(0,0,0,.38);
      margin-top: 0; /* –±—É–ª–æ 28px */
    }

    #slide4 .flow-copy strong{
      color:#000;
      font-weight:800;
    }

    .proto-layout{margin-top:16px;display:grid;grid-template-columns:1.05fr .95fr;gap:16px;align-items:stretch;flex:1;min-height:0}
    .panel{background:#fff;border:1px solid rgba(0,0,0,.10);border-radius:18px;padding:18px;box-shadow:0 18px 50px rgba(0,0,0,.06);position:relative;overflow:hidden;display:flex;flex-direction:column}
    .panel.accent::before{content:"";position:absolute;inset:0;border-radius:18px;pointer-events:none;background:linear-gradient(135deg,rgba(212,255,0,.22),rgba(212,255,0,0) 55%)}
    .pk{--fs:11px;font-weight:800;letter-spacing:.12em;text-transform:uppercase;color:rgba(0,0,0,.45);position:relative;z-index:1}
    .pt{margin-top:8px;--fs:18px;font-weight:800;letter-spacing:-.02em;color:#000;position:relative;z-index:1}
    .hero{margin-top:12px;border-radius:16px;background:rgba(0,0,0,.06);border:1px solid rgba(0,0,0,.10);overflow:hidden;position:relative;z-index:1;flex:1;min-height:300px;display:flex;align-items:center;justify-content:center}
    .proto-carousel{display:block;padding:0;cursor:pointer}
    .carousel-img{width:100%;height:100%;object-fit:cover;object-position:var(--crop-x, 50%) var(--crop-y, 50%);display:block;transition:opacity 160ms ease}
    .carousel-fallback{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:16px;color:rgba(0,0,0,.45);font-weight:800;letter-spacing:.08em;text-transform:uppercase;font-size:11px;text-align:center;pointer-events:none}
    .carousel-btn{position:absolute;top:50%;transform:translateY(-50%);width:28px;height:28px;border-radius:50%;border:1px solid rgba(0,0,0,.18);background:rgba(255,255,255,.78);backdrop-filter:blur(6px);cursor:pointer;font-weight:800;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 160ms ease;z-index:2;font-size:13px}
    .proto-carousel:hover .carousel-btn,.proto-carousel:focus-within .carousel-btn{opacity:1}
    .carousel-btn:hover{background:#d4ff00;border-color:#d4ff00}
    .carousel-btn:disabled{opacity:.25;cursor:not-allowed}
    .carousel-btn.prev{left:8px}.carousel-btn.next{right:8px}
    .carousel-dots{position:absolute;left:50%;bottom:10px;transform:translateX(-50%);display:flex;gap:6px;padding:5px 7px;border-radius:999px;background:rgba(255,255,255,.70);border:1px solid rgba(0,0,0,.12);opacity:0;transition:opacity 160ms ease;z-index:2}
    .proto-carousel:hover .carousel-dots,.proto-carousel:focus-within .carousel-dots{opacity:1}
    .carousel-dot{width:7px;height:7px;border-radius:999px;border:1px solid rgba(0,0,0,.28);background:rgba(0,0,0,.10);cursor:pointer;padding:0}
    .carousel-dot.active{background:rgba(0,0,0,.55);border-color:rgba(0,0,0,.55)}
    .carousel-count{position:absolute;right:10px;bottom:10px;font-size:10px;font-weight:700;color:rgba(0,0,0,.45);background:rgba(255,255,255,.70);border:1px solid rgba(0,0,0,.12);padding:5px 8px;border-radius:999px;opacity:0;transition:opacity 160ms ease;z-index:2;user-select:none}
    .proto-carousel:hover .carousel-count,.proto-carousel:focus-within .carousel-count{opacity:1}
    .caption{margin-top:12px;position:relative;z-index:1;--fs:12.5px;line-height:1.5;color:#111;padding:10px 12px;border-radius:12px;background:rgba(0,0,0,.03);border:1px solid rgba(0,0,0,.08)}
    .plist{list-style:none;margin-top:14px;display:grid;gap:14px;position:relative;z-index:1;padding:0}
    .plist li{padding:14px 16px;border-radius:14px;background:rgba(0,0,0,.03);border:1px solid rgba(0,0,0,.08);--fs:14.5px;line-height:1.55;color:#111}
    .pchips{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;position:relative;z-index:1}

    .nav,
    .sub,
    .slide-number,
    .description p,
    .visual-label,
    .visual-notes li,
    .kicker,
    .ctitle,
    .clist .label,
    .clist .value,
    .analogy p,
    .flow-copy,
    .chip,
    .pk,
    .pt,
    .caption,
    .plist li {
      font-size: calc(var(--fs, 14px) * var(--textCompSmall));
    }

    .nav-buttons{position:fixed;right:28px;bottom:28px;display:flex;gap:8px;z-index:9999}
    .nav-btn{width:36px;height:36px;background:#fff;border:2px solid #000;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:16px;cursor:pointer;transition:all .3s;font-weight:700}
    .nav-btn:hover{background:#d4ff00;border-color:#d4ff00;transform:scale(1.1)}
    .nav-btn:disabled{opacity:.3;cursor:not-allowed}
    .nav-btn:disabled:hover{background:#fff;border-color:#000;transform:scale(1)}

    /* scrubber capsule */
    .slide-scrubber{
      position: fixed;
      left: 50%;
      bottom: calc(var(--ui-gap) + env(safe-area-inset-bottom, 0px));
      transform: translateX(-50%);
      z-index: 9998;

      padding: var(--scrub-pad-y) var(--scrub-pad-x);
      border-radius: 999px;
      background: rgba(255,255,255,.06);          /* –±–µ–∫–≥—Ä–∞—É–Ω–¥ —Ç–æ–Ω—à–∏–π */
      box-shadow: 0 10px 28px rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* range sizing */
    .slide-scrubber input[type=range]{
      width: var(--scrub-w);
      height: 16px;
      background: transparent;
      appearance: none;
      -webkit-appearance: none;
    }
    .slide-scrubber input[type=range]:focus{ outline:none; }

    /* Track */
    .slide-scrubber input[type=range]::-webkit-slider-runnable-track{
      height: 2px;
      border-radius: 999px;
      background: rgba(255,255,255,.24);
    }
    .slide-scrubber input[type=range]::-moz-range-track{
      height: 2px;
      border-radius: 999px;
      background: rgba(255,255,255,.24);
    }

    /* Thumb */
    .slide-scrubber input[type=range]::-webkit-slider-thumb{
      -webkit-appearance:none;
      width: 9px;
      height: 9px;
      border-radius: 999px;
      margin-top: -3.5px;                          /* —Ü–µ–Ω—Ç—Ä—É—î –Ω–∞ —Ç—Ä–µ–∫—É 2px */
      background: rgba(255,255,255,.92);
      box-shadow: 0 6px 14px rgba(0,0,0,.28);
    }
    .slide-scrubber input[type=range]::-moz-range-thumb{
      width: 9px;
      height: 9px;
      border-radius: 999px;
      border: none;
      background: rgba(255,255,255,.92);
      box-shadow: 0 6px 14px rgba(0,0,0,.28);
    }

    .mini-counter{position:fixed;left:28px;bottom:28px;z-index:9999;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);padding:8px 10px;border-radius:999px;background:rgba(255,255,255,.10);color:rgba(255,255,255,.85);font-size:12px;font-weight:700;letter-spacing:.02em;user-select:none}

    @media (prefers-reduced-motion: reduce){.slide{transition:none}.timer-hand{animation:none}}
    @media (max-width:768px){
      :root{ --page-pad: 12px; }
      .nav-buttons{right:14px;bottom:14px}
      .mini-counter{left:14px;bottom:14px}
      .slide{padding:22px}
      .title-section h1{font-size:56px;letter-spacing:-1.5px}
      .title-section .tm{font-size:22px}
      .year-badge{font-size:20px;padding:6px 12px;margin-top:10px}
      .description{max-width:100%;margin-top:12px}
      .description p{font-size:11.5px}
      .nav{gap:12px;font-size:11px}
      .nav-item.active{padding:3px 10px}
      .timer-icon{width:280px;height:280px;right:-110px;top:52%}
      .timer-circle{border-width:22px}
      .timer-hand{height:110px}
      .timer-center{width:40px;height:40px}
      h2{font-size:34px}
      .flow-title{font-size:44px}
      .flow-label{font-size:28px}
      .concept-grid,.visual-grid,.proto-layout{grid-template-columns:1fr}
      .slide-scrubber{
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        width: min(60vw, 260px);
        bottom: calc(var(--ui-gap) + 56px + env(safe-area-inset-bottom, 0px));
        border-radius: 999px;
      }
      .slide-scrubber input[type=range]{width:100%}
    }

    /* mobile presentation window: keep desktop-style grids to avoid vertical overflow */
    @media (max-width:768px){
      body.is-mobile .concept-grid,
      body.is-mobile .visual-grid,
      body.is-mobile .proto-layout{
        grid-template-columns: 1fr 1fr;
      }
      body.is-mobile #final_pick .pick-layout{
        grid-template-columns: 1fr 1.05fr;
      }
    }

    /* –Ω–∞ –Ω–∏–∑—å–∫–∏—Ö –µ–∫—Ä–∞–Ω–∞—Ö —â–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ñ—à–µ */
    @media (max-height: 760px){
      :root{
        --ui-gap: 10px;
        --scrub-w: clamp(200px, 46vw, 320px);
        --ui-reserve: calc(var(--ui-gap) + 28px + 14px);
      }
    }

    /* === Slide 01: layout + typography polish (more premium, less ‚Äústuck to left‚Äù) === */
    #slide1{
      /* —Ç—Ä—ñ—à–∫–∏ –±—ñ–ª—å—à–µ breathing room + –∫—Ä–∞—â–∞ ‚Äú–∫–æ–º–ø–æ–∑–∏—Ü—ñ—è‚Äù */
      padding: 60px 86px 62px 92px;

      /* –ª–µ–≥–∫–∏–π –∂–∏–≤–∏–π —Ñ–æ–Ω, —â–æ–± –±—É–ª–æ –≤—ñ–¥—á—É—Ç—Ç—è –¥–∏–∑–∞–π–Ω—É */
      background:
        radial-gradient(900px 520px at 18% 20%, rgba(212,255,0,.10), rgba(0,0,0,0) 55%),
        radial-gradient(900px 520px at 90% 70%, rgba(0,0,0,.06), rgba(0,0,0,0) 60%),
        #f5f5f5;

      --hero-comp: clamp(1, calc(1 / var(--scale)), 1.45);
      --s1-body-fs: 15.5px; /* ‚¨ÖÔ∏è –≥–æ–ª–æ–≤–Ω–µ: —Ç–µ–∫—Å—Ç —Å—Ç–∞–≤ –±—ñ–ª—å—à–∏–π */
      --s1-body-lh: 1.78;
      --s1-max: 620px;      /* ‚¨ÖÔ∏è –æ–±–º–µ–∂—É—î —à–∏—Ä–∏–Ω—É ‚Äî –≤–∏–≥–ª—è–¥–∞—î –¥–æ—Ä–æ–∂—á–µ */
    }

    /* —Ä–æ–±–∏–º–æ —Ö–µ–¥–µ—Ä ‚Äú–¥–∏–∑–∞–π–Ω–µ—Ä—Å—å–∫–∏–º‚Äù: 2 –∫–æ–ª–æ–Ω–∫–∏, –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π –±–∞–ª–∞–Ω—Å */
    #slide1 .header{
      display: grid;
      grid-template-columns: minmax(520px, 1fr) auto;
      align-items: start;
      column-gap: 54px;
    }

    /* –∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Äî —Ç—Ä–æ—Ö–∏ –º–∞—Å–∏–≤–Ω—ñ—à–∏–π —ñ —á–∏—Å—Ç—ñ—à–∏–π */
    #slide1 .title-section h1{
      font-size: calc(132px * var(--hero-comp));
      letter-spacing: -3.2px;
      line-height: .92;
      font-weight: 800;
    }

    /* –±–µ–π–¥–∂ —Ä–æ–∫—É ‚Äî —Ç—Ä–æ—Ö–∏ –±—ñ–ª—å—à–µ ‚Äú–≤–∞–≥–∏‚Äù —ñ –ø–æ–≤—ñ—Ç—Ä—è */
    #slide1 .year-badge{
      font-size: calc(40px * var(--hero-comp));
      padding: calc(10px * var(--hero-comp)) calc(22px * var(--hero-comp));
      border-radius: calc(8px * var(--hero-comp));
      margin-top: 18px;
      box-shadow: 0 10px 26px rgba(212,255,0,.18);
    }

    #slide1 .description p{
      font-size: calc(var(--s1-body-fs) * var(--textCompSmall));
      line-height: var(--s1-body-lh);
      color: rgba(0,0,0,.82);
      margin-bottom: 16px;
      font-weight: 450;
      letter-spacing: .01em;
    }

    /* –æ—Å—Ç–∞–Ω–Ω—ñ–π –∞–±–∑–∞—Ü (bold) ‚Äî –±—ñ–ª—å—à ‚Äúpremium‚Äù */
    #slide1 .description p:last-child{
      font-weight: 650 !important;
      color: rgba(0,0,0,.88);
    }

    /* –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è ‚Äî —Ç—Ä–æ—à–∫–∏ –ª–µ–≥—à–∞ —ñ —Ä—ñ–≤–Ω—ñ—à–∞ */
    #slide1 .nav{
      gap: 26px;
      align-items: center;
      font-size: calc(13px * var(--hero-comp));
      color: rgba(0,0,0,.55);
    }

    #slide1 .nav-item{
      color: rgba(0,0,0,.50);
    }

    #slide1 .nav-item.active{
      padding: 6px 14px;
      border-radius: 8px;
      background: #d4ff00;
      color: #000;
      box-shadow: 0 10px 26px rgba(212,255,0,.16);
    }

    /* —Ç–∞–π–º–µ—Ä: —Ç—Ä–æ—Ö–∏ –º–µ–Ω—à–µ ‚Äú—Ç–∏—Å–Ω–µ‚Äù, –∫—Ä–∞—â–µ —Å—ñ–¥–∞—î –≤ –∫–æ–º–ø–æ–∑–∏—Ü—ñ—é */
    #slide1 .timer-icon{
      right: -140px;
      top: 52%;
      filter: drop-shadow(0 26px 56px rgba(0,0,0,.10));
      opacity: .95;
    }

    /* —â–æ–± –Ω–∞ –º–∞–ª–∏—Ö —Å–∫–µ–π–ª–∞—Ö —Ç–µ–∂ —á–∏—Ç–∞–ª–æ—Å—å */
    @media (max-width: 900px){
      #slide1 .header{ grid-template-columns: 1fr; row-gap: 18px; }
      #slide1 .timer-icon{ opacity: .35; right: -220px; top: 58%; }
    }

    /* === Slide 01: make description lighter (less ‚Äúcompressed column‚Äù) === */
    #slide1{
      --s1-max: 720px;        /* –±—É–ª–æ 620 ‚Äî —à–∏—Ä—à–µ = –ª–µ–≥—à–µ */
      --s1-body-fs: 15px;   /* —Ç—Ä–æ—Ö–∏ –±—ñ–ª—å—à–∏–π —Ç–µ–∫—Å—Ç */
      --s1-body-lh: 1.84;     /* –±—ñ–ª—å—à–µ –ø–æ–≤—ñ—Ç—Ä—è –º—ñ–∂ —Ä—è–¥–∫–∞–º–∏ */
    }

    #slide1 .description{
      margin-top: 26px;       /* —Ç—Ä–æ—Ö–∏ –Ω–∏–∂—á–µ –≤—ñ–¥ –±–µ–π–¥–∂–∞ */
    }

    #slide1 .description p{
      font-size: calc(var(--s1-body-fs) * var(--textCompSmall));
      line-height: var(--s1-body-lh);
      color: rgba(0,0,0,.78);
      letter-spacing: .012em;
      margin-bottom: 0;       /* –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Ç–º—É –Ω–∏–∂—á–µ */
      font-weight: 420;
    }

    /* —Ä–∏—Ç–º –º—ñ–∂ –∞–±–∑–∞—Ü–∞–º–∏ */
    #slide1 .description p + p{
      margin-top: 16px !important;
    }

    /* –ø—Ä–∏–±–∏–≤–∞—î–º–æ inline margin-top, —â–æ–± –Ω–µ –ª–∞–º–∞–≤ —Ä–∏—Ç–º */
    #slide1 .description p[style*="margin-top"]{
      margin-top: 16px !important;
    }

    /* –æ—Å—Ç–∞–Ω–Ω—ñ–π ‚Äî —Ç—Ä–æ—Ö–∏ —Å–∏–ª—å–Ω—ñ—à–µ, –∞–ª–µ –Ω–µ ‚Äú–∂–∏—Ä–Ω—é—á–∏–π‚Äù */
    #slide1 .description p:last-child{
      font-weight: 650 !important;
      color: rgba(0,0,0,.86);
    }

    /* make description feel less ‚Äúblocky‚Äù */
    #slide1 .description{
      padding-right: 38px;      /* –ª–µ–≥–∫–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä —Å–ø—Ä–∞–≤–∞ */
    }

    #slide1 .description p{
      max-width: none;      /* ‚ùó –∑–Ω—ñ–º–∞—î–º–æ –æ–±–º–µ–∂–µ–Ω–Ω—è */
    }

    /* === Slide 01 width controller (clean) === */
    #slide1{
      --s1-title-max: 980px; /* —à–∏—Ä–∏–Ω–∞ –≤—Å—ñ—î—ó –ª—ñ–≤–æ—ó –∫–æ–ª–æ–Ω–∫–∏ */
      --s1-desc-max: 980px;  /* —à–∏—Ä–∏–Ω–∞ –æ–ø–∏—Å—É (–º–æ–∂–µ –±—É—Ç–∏ –º–µ–Ω—à–µ/–±—ñ–ª—å—à–µ) */
    }

    #slide1 .title-section{
      max-width: var(--s1-title-max);
    }

    #slide1 .description{
      max-width: var(--s1-desc-max);
    }

    #slide1 .description p{
      max-width: none;
    }

    /* =========================
       FINAL PICK SLIDE (clean)
       ========================= */

    #final_pick{
      --pick-gap: 18px;
    }

    #final_pick .pick-layout{
      margin-top: 20px;
      display: grid;
      grid-template-columns: 1fr 1.15fr;
      gap: var(--pick-gap);
      align-items: stretch;
      flex: 1;
      min-height: 0;
    }

    #final_pick .pick-grid{
      background:#fff;
      border:1px solid rgba(0,0,0,.10);
      border-radius:20px;
      box-shadow:0 18px 50px rgba(0,0,0,.06);
      padding: 18px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 14px;
      min-height: 0;
      overflow: auto;
    }

     /* =========================
       VIDEO ASSISTANT (PiP)
       ========================= */

    :root{
      --pip-size: 220px;          /* –±–∞–∑–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä */
      --pip-radius: 18px;
      --pip-pad: 10px;
      --pip-z: 9997;
    }

    /* container */
    .pip{
      position: fixed;
      right: 22px;
      top: 22px;
      width: var(--pip-size);
      aspect-ratio: 1 / 1;        /* –∫–≤–∞–¥—Ä–∞—Ç */
      z-index: var(--pip-z);

      border-radius: var(--pip-radius);
      overflow: visible;

      background: rgba(20,20,20,.55);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 22px 60px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);

      cursor: default;
      user-select: none;
      touch-action: none;
    }
    .pip:active{ cursor: grabbing; }

    .pip-inner{
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: var(--pip-radius);
      overflow: hidden;
    }

    /* iframe */
    .pip-frame{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:0;
      display:block;
      opacity: 0;                 /* –ø–æ–∫–∞–∑—É—î–º–æ —Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ —Ä–µ–∞–ª—å–Ω–æ –≥—Ä–∞—î */
    }

    /* optional brightness boost for darker slides */
    .pip.is-brightened .pip-frame{
      filter: brightness(1.15) saturate(1.05);
    }

    /* overlay */
    .pip-overlay{
      position:absolute;
      inset:0;
      z-index: 2;
      display:flex;
      flex-direction:column;
      justify-content:flex-end;
      gap: 8px;
      padding: 12px;
      padding-bottom: 58px; /* reserve space for floating controls */
      background:
        radial-gradient(240px 240px at 20% 20%, rgba(212,255,0,.18), rgba(0,0,0,0) 65%),
        linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.55));
      color: rgba(255,255,255,.92);
      border: 1px solid rgba(255,255,255,.10);
      pointer-events: none;
    }

    .pip-badge{
      position:absolute;
      left: 12px;
      top: 12px;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.40);
      border: 1px solid rgba(255,255,255,.14);
      font-size: 10px;
      font-weight: 800;
      letter-spacing: .12em;
      text-transform: uppercase;
    }

    .pip-title{
      font-size: 14px;
      font-weight: 800;
      letter-spacing: -.01em;
      line-height: 1.15;
    }
    .pip-sub{
      font-size: 12px;
      line-height: 1.35;
      color: rgba(255,255,255,.72);
    }

    .pip-controls{
      display:flex;
      gap: 8px;
      margin-top: 2px;
    }

    .pip-controls.floating{
      position: absolute;
      left: 12px;
      right: 12px;
      bottom: 6px;
      z-index: 4;
      pointer-events: auto;
    }

    .pip-drag-handle{
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      height: 38px;
      z-index: 5;
      cursor: grab;
      pointer-events: auto;
      background: transparent;
    }
    .pip-drag-handle:active{ cursor: grabbing; }

    .pip-btn{
      flex: 1 1 auto;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(212,255,0,.92);
      color:#000;
      font-weight: 800;
      padding: 9px 10px;
      cursor:pointer;
      font-size: 12px;
    }
    .pip-btn.ghost{
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.86);
    }
    .pip-btn:disabled{
      opacity: .45;
      cursor: not-allowed;
    }

    /* minimize button */
    .pip-min{
      position:absolute;
      right: 8px;
      top: 8px;

      width: 28px;
      height: 28px;
      border-radius: 999px;

      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.22);

      cursor: pointer;
      z-index: 10;

      display: grid;
      place-items: center;

      /* –ø—Ä–∏–±–∏—Ä–∞—î–º–æ ‚Äú—Ç–µ–∫—Å—Ç–æ–≤–∏–π –º—ñ–Ω—É—Å‚Äù –≤–ø–ª–∏–≤ */
      font-size: 0;
      line-height: 0;
      padding: 0;
    }

    .pip-min::before{
      content:"";
      width: 12px;          /* –¥–æ–≤–∂–∏–Ω–∞ —Ä–∏—Å–∫–∏ */
      height: 2px;          /* —Ç–æ–≤—â–∏–Ω–∞ */
      border-radius: 999px;
      background: rgba(255,255,255,.85);
      transform: translateY(0.5px); /* –ª–µ–≥–∫–µ –æ–ø—Ç–∏—á–Ω–µ —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è */
    }

    .pip-min:hover{
      background: rgba(255,255,255,.08);
      border-color: rgba(255,255,255,.22);
    }

    .pip-min:active{
      transform: scale(.96);
    }

    .pip[data-state="playing"]{ cursor: default; }

    /* state playing/ready: overlay less visible */
    .pip[data-state="playing"] .pip-frame{ opacity: 1; }
    .pip[data-state="ready"] .pip-frame{ opacity: 1; }
    .pip[data-state="playing"] .pip-overlay,
    .pip[data-state="ready"] .pip-overlay{
      opacity: 0;
    }

    /* minimized state: hide PiP */
    .pip.is-minimized{
      display: none;
    }

    /* Hide PiP on full-screen photo slides */
    .pip.is-suppressed{ display:none; }
    .pip-launch.is-suppressed{ display:none !important; }

    /* launcher button (small icon near nav) */
    .pip-launch{
      position: fixed;
      right: 28px;
      bottom: 76px;           /* üëà —â–æ–± –±—É–ª–æ –±—ñ–ª—è —Å—Ç—Ä—ñ–ª–æ–∫, –∞–ª–µ –Ω–µ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞–ª–æ */
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: 2px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.92);
      font-weight: 900;
      cursor: pointer;
      z-index: 9999;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
      display: none;          /* –ø–æ–∫–∞–∑—É—î–º–æ —Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ minimized */
    }

    .pip-launch:hover{
      transform: scale(1.06);
    }

    /* show launcher when needed */
    .pip-launch.is-visible{
      display: grid;
      place-items: center;
    }

    /* helper badge */
    .pip-hint{
      position:absolute;
      left: 50%;
      top: -36px;                 /* üëà –ø—ñ–¥–Ω—ñ–º–∞—î –Ω–∞–¥ PiP */
      transform: translateX(-50%);
      padding: 7px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      color: rgba(255,255,255,.92);
      font-size: 10px;
      font-weight: 800;
      letter-spacing: .12em;
      text-transform: uppercase;
      display:none;
      pointer-events:none;
      z-index: 9999;              /* ‚úÖ –ø–æ–≤–µ—Ä—Ö PiP */
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    body.is-mobile .pip-hint{
      top: -28px;
      padding: 5px 9px;
      font-size: 8px;
      letter-spacing: .1em;
    }

    /* nudge anim */
    @keyframes pipNudge {
      0%   { transform: translateX(0); }
      35%  { transform: translateX(-14px); }
      70%  { transform: translateX(0); }
      100% { transform: translateX(0); }
    }

    /* extra obvious blink/glow */
    @keyframes pipGlow {
      0%   { box-shadow: 0 22px 60px rgba(0,0,0,.35), 0 0 0 0 rgba(212,255,0,0); }
      40%  { box-shadow: 0 22px 60px rgba(0,0,0,.35), 0 0 0 6px rgba(212,255,0,.22); }
      100% { box-shadow: 0 22px 60px rgba(0,0,0,.35), 0 0 0 0 rgba(212,255,0,0); }
    }

    .pip.is-hinting{
      animation: pipNudge 520ms ease-out 1, pipGlow 900ms ease-out 1;
    }
    .pip.is-hinting .pip-hint{ display:block; }
    .pip.is-touched .pip-hint{ display:none !important; } /* ‚úÖ –ø—ñ—Å–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó —Ö–æ–≤–∞—î–º–æ –Ω–∞–∑–∞–≤–∂–¥–∏ */

    /* mobile: slightly smaller */
    @media (max-width: 768px){
      :root{ --pip-size: 190px; }
      .pip{ right: 12px; top: 12px; }
    }

    #final_pick .pick-card{
      display:flex;
      gap: 12px;
      align-items:center;
      padding: 14px;
      border-radius: 16px;
      border: 1px solid rgba(0,0,0,.10);
      background: rgba(0,0,0,.02);
      cursor: pointer;
      transition:
        transform 160ms ease,
        background-color 160ms ease,
        border-color 160ms ease;
      user-select:none;
    }

    #final_pick .pick-card:hover{
      transform: translateY(-1px);
      background: rgba(0,0,0,.03);
      border-color: rgba(0,0,0,.18);
    }

    #final_pick .pick-card.selected{
      background: rgba(212,255,0,.22);
      border-color: rgba(0,0,0,.22);
      box-shadow: 0 14px 36px rgba(212,255,0,.18);
    }

    #final_pick .pick-thumb{
      width: 78px;
      height: 78px;
      border-radius: 14px;
      background: rgba(0,0,0,.08);
      overflow:hidden;
      flex: 0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    #final_pick .pick-thumb img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }

    #final_pick .pick-meta .name{
      font-weight: 800;
      color:#000;
      font-size: calc(16px * var(--textCompSmall));
      line-height: 1.1;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    #final_pick .pick-meta .desc{
      font-size: calc(13px * var(--textCompSmall));
      color: rgba(0,0,0,.55);
      line-height: 1.25;
    }

    /* RIGHT SIDE: make preview true 16:9, feedback becomes flexible */
    #final_pick .pick-panel{
      background:#fff;
      border:1px solid rgba(0,0,0,.10);
      border-radius:20px;
      box-shadow:0 18px 50px rgba(0,0,0,.06);
      padding: 20px;
      min-height:0;
      overflow:hidden;

      display: grid;
      grid-template-rows: auto auto auto 1fr; /* pk, title, preview, actions */
      gap: 12px;
    }

    #final_pick .pick-preview{
      border-radius: 18px;
      background: rgba(0,0,0,.06);
      border: 1px solid rgba(0,0,0,.10);
      overflow: hidden;

      aspect-ratio: 16 / 9;
      width: 100%;
      height: auto;

      /* IMPORTANT: no max-height, so ratio stays true */
      max-height: none;
    }

    #final_pick #pickPreviewImg{
      width:100%;
      height:100%;
      object-fit: cover; /* –±–µ–∑ —Å—ñ—Ä–∏—Ö –±–∞—Ä—ñ–≤ */
      object-position: var(--crop-x, 50%) var(--crop-y, 50%);
      display:block;
      opacity: 0;
      transition: opacity 160ms ease;
    }

    #final_pick .pick-preview-fallback{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(0,0,0,.45);
      font-weight: 800;
      letter-spacing: .08em;
      text-transform: uppercase;
      font-size: 11px;
      text-align:center;
      padding: 16px;
    }

    #final_pick .pick-actions{
      display:flex;
      flex-direction:column;
      gap: 10px;
      min-height: 0;
      overflow: auto; /* —è–∫—â–æ –º–∞–ª–æ –º—ñ—Å—Ü—è ‚Äî —Å–∫—Ä–æ–ª —Ç—É—Ç, –∞ –Ω–µ –ø—Ä–µ–≤ º—é */
    }

    #final_pick .pick-text{
      width:100%;
      border-radius: 16px;
      border:1px solid rgba(0,0,0,.12);
      background: rgba(0,0,0,.02);
      padding: 14px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
      font-size: calc(14px * var(--textCompSmall));
      line-height: 1.5;
      resize: none;
      min-height: 150px;
    }

    #final_pick .pick-btn{
      border-radius: 14px;
      border:1px solid rgba(0,0,0,.18);
      background: #d4ff00;
      padding: 11px 14px;
      font-weight: 800;
      cursor:pointer;
      font-size: calc(13px * var(--textCompSmall));
    }

    #final_pick .pick-btn.ghost{
      background: rgba(0,0,0,.02);
    }

    #final_pick .pick-hint{
      font-size: calc(12px * var(--textCompSmall));
      color: rgba(0,0,0,.45);
    }

    @media (max-width: 920px){
      #final_pick .pick-layout{ grid-template-columns: 1fr; }
      #final_pick .pick-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }

    /* FINAL PICK ‚Äî no scrollbars, everything fits */

    #final_pick .pick-panel{
      grid-template-rows: auto auto auto auto; /* –±–µ–∑ 1fr */
      gap: 10px;
    }

    /* remove any scroll in feedback block */
    #final_pick .pick-actions{
      overflow: hidden;      /* –±—É–ª–æ auto */
      min-height: unset;
      gap: 8px;
    }

    /* smaller textarea + no resize */
    #final_pick .pick-text{
      min-height: 92px;      /* –±—É–ª–æ 150 */
      height: 92px;          /* —Ñ—ñ–∫—Å—É—î–º–æ, —â–æ–± –Ω–µ —Ä–æ–∑–¥—É–≤–∞–ª–æ */
      resize: none;          /* –ø—Ä–∏–±—Ä–∞—Ç–∏ —Ä—É—á–∫—É resize */
      padding: 12px;
    }

    /* slightly more compact buttons/hint */
    #final_pick .pick-btns{ gap: 8px; }
    #final_pick .pick-btn{ padding: 10px 12px; }
    #final_pick .pick-hint{ margin-top: 0; }

    /* if textarea inside grid/flex squeezes height */
    #final_pick .pick-preview{
      margin-top: 6px;
    }

    /* FIX: fallback overlay must be inside preview only */
    #final_pick .pick-preview{ position: relative; }
    #final_pick .pick-preview-fallback{ pointer-events: none; }

    /* FINAL PICK ‚Äî clean feedback area */
    #final_pick .pick-panel{
      /* –±—É–ª–æ: auto auto auto auto */
      grid-template-rows: auto auto 1fr auto; /* header, title, preview, feedback */
      gap: 12px;
    }

    #final_pick .pick-preview{
      position: relative;
      margin-top: 6px;
      border-radius: 18px;
      overflow: hidden;
    }

    /* FEEDBACK block = separate panel */
    #final_pick .pick-actions{
      margin-top: 4px;
      padding-top: 10px;
      border-top: 1px solid rgba(0,0,0,.10);

      display: grid;
      grid-template-columns: 1fr auto;   /* textarea + buttons */
      grid-template-rows: auto auto;     /* label row + content row */
      gap: 10px 12px;

      overflow: hidden;
    }

    /* label (FEEDBACK) spans full row */
    #final_pick .pick-actions .pk{
      grid-column: 1 / -1;
      margin: 0;
    }

    /* textarea ‚Äî comfortable height, avoid scroll if possible */
    #final_pick .pick-text{
      grid-column: 1 / 2;
      height: 76px;
      min-height: 76px;
      resize: none;
      padding: 12px 12px;
      line-height: 1.45;
    }

    /* buttons ‚Äî vertical on the right */
    #final_pick .pick-btns{
      grid-column: 2 / 3;
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-self: start;
    }

    #final_pick .pick-btn{
      width: 84px;
      padding: 10px 10px;
      border-radius: 12px;
    }

    /* hint below, easier to read */
    #final_pick .pick-hint{
      grid-column: 1 / -1;
      margin: 0;
    }

    /* Mobile: keep preview and feedback separated */
    body.is-mobile #final_pick .pick-panel{
      grid-template-rows: auto auto auto auto;
    }
    body.is-mobile #final_pick .pick-preview{
      margin-bottom: 8px;
    }
    body.is-mobile #final_pick .pick-actions{
      margin-top: 10px;
    }
    body.is-mobile .slide-scrubber{
      bottom: calc(var(--ui-gap) + 96px + env(safe-area-inset-bottom, 0px));
    }

    /* FINAL PICK ‚Äî smaller buttons + thinner scrollbar + feedback lower */

    #final_pick .pick-actions{
      /* move block down, closer to Tip */
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(0,0,0,.10);

      /* more space for textarea */
      gap: 10px 10px;
    }

    /* textarea ‚Äî slightly bigger for readability */
    #final_pick .pick-text{
      height: 92px;
      min-height: 92px;
      padding: 12px 12px;
    }

    /* smaller buttons */
    #final_pick .pick-btn{
      width: 70px;
      padding: 7px 9px;
      border-radius: 11px;
      font-size: calc(12px * var(--textCompSmall));
    }

    /* smaller gap between buttons */
    #final_pick .pick-btns{
      gap: 6px;
    }

    /* thinner scrollbar in textarea (Chrome/Edge/Safari) */
    #final_pick .pick-text::-webkit-scrollbar{
      width: 6px;
    }
    #final_pick .pick-text::-webkit-scrollbar-track{
      background: rgba(0,0,0,.06);
      border-radius: 999px;
    }
    #final_pick .pick-text::-webkit-scrollbar-thumb{
      background: rgba(0,0,0,.22);
      border-radius: 999px;
    }
    #final_pick .pick-text::-webkit-scrollbar-thumb:hover{
      background: rgba(0,0,0,.32);
    }

    /* Firefox */
    #final_pick .pick-text{
      scrollbar-width: thin;
      scrollbar-color: rgba(0,0,0,.25) rgba(0,0,0,.06);
    }

    /* push Tip slightly lower for grounded look */
    #final_pick .pick-hint{
      margin-top: 6px;
    }

  </style>
</head>
<body>
  <div class="viewport">
    <div class="presentation-stage" id="deck">

    <div class="slide active" id="slide1">
      <div class="header">
        <div class="title-section">
          <h1>Focus<span class="tm">‚Ñ¢</span></h1>
          <div class="year-badge">2026</div>
          <div class="description">
            <p>This is not a product. It's an experiment.</p>
            <p style="margin-top:18px;">Can one person complete the full product launch cycle ‚Äî from idea and 3D to<br>an e‚Äëcommerce site and ads?</p>
            <p>Focus Object doesn't physically exist. I'm creating its visual language, packaging, and presence to test how design affects the desire to buy.</p>
            <p style="font-weight:600;margin-top:18px;">Your feedback will decide which prototype becomes the real embodiment of the idea.</p>
          </div>
        </div>
        <div class="nav">
          <div class="nav-item active">PROJECT</div>
          <div class="nav-item">DELIVERY</div>
          <div class="nav-item">CONTACTS</div>
        </div>
      </div>
      <div class="timer-icon"><div class="timer-circle"><div class="timer-hand"></div><div class="timer-center"></div></div></div>
    </div>

    <div class="slide content-slide" id="slide2">
      <div class="slide-number">02</div>
      <div>
        <h2>Visual Context</h2>
        <p class="sub">The market reality today vs the direction I'm aiming for.</p>
      </div>
      <div class="visual-grid">
        <div class="visual-column noisy">
          <div class="visual-label">ALREADY EXISTS</div>
          <div class="visual-collage" aria-label="Already Exists examples">
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo01.png" alt="Already exists 01"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo02.png" alt="Already exists 02"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo03.png" alt="Already exists 03"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo04.png" alt="Already exists 04"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo05.png" alt="Already exists 05"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo06.png" alt="Already exists 06"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo07.png" alt="Already exists 07"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/already-exists/ax_photo08.png" alt="Already exists 08"></div>
          </div>
          <ul class="visual-notes">
            <li>Visual noise ‚Äî looks like a gadget or a toy</li>
            <li>Digits dominate ‚Äî focus is on the screen, not the process</li>
            <li>"Just another device" ‚Äî function without character</li>
            <li>Always active ‚Äî pulls attention even without interaction</li>
          </ul>
        </div>
        <div class="visual-column calm">
          <div class="visual-label">DIRECTION</div>
          <div class="visual-collage" aria-label="Direction references">
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo01.png" alt="Direction 01"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo02.png" alt="Direction 02"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo03.png" alt="Direction 03"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo04.png" alt="Direction 04"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo05.png" alt="Direction 05"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo06.png" alt="Direction 06"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo07.png" alt="Direction 07"></div>
            <div class="tile"><img class="thumb" src="image/slide-3/direction/dire_photo08.png" alt="Direction 08"></div>
          </div>
          <ul class="visual-notes">
            <li>Designer object ‚Äî clean form, you want to keep it on the desk</li>
            <li>Silence as a feature ‚Äî minimal signals, maximum concentration</li>
            <li>Part of a work ritual ‚Äî starts as an action or intent, not as a "timer"</li>
            <li>Does nothing until you do ‚Äî responds only to your start, never lives in the background</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="slide content-slide" id="slide3">
      <div class="slide-number">03</div>
      <div>
        <h2>Product Concept</h2>
        <p class="sub">Why this isn't another Pomodoro, but a ritual object for entering a focus state.</p>
      </div>
      <div class="concept-grid">
        <div class="card">
          <div class="kicker">WHAT EXISTS</div>
          <div class="ctitle">Traditional Pomodoro</div>
          <ul class="clist">
            <li><span class="label">Tool</span><span class="value">a timer as a strict utility for counting minutes.</span></li>
            <li><span class="label">Logic</span><span class="value">control through deadline pressure and sharp "stop" signals.</span></li>
            <li><span class="label">Feeling</span><span class="value">visual noise of numbers "staring" at you and creating background stress.</span></li>
            <li><span class="label">Role</span><span class="value">a technical gadget used only for work and then put away.</span></li>
          </ul>
        </div>
        <div class="card accent">
          <div class="kicker">WHAT I PROPOSE</div>
          <div class="ctitle">Focus Object ‚Äî Lo‚Äëfi Philosophy</div>
          <ul class="clist">
            <li><span class="label">Tool</span><span class="value">a ritual object that helps you smoothly enter flow.</span></li>
            <li><span class="label">Logic</span><span class="value">intention instead of pressure; supports depth of focus rather than dictating it.</span></li>
            <li><span class="label">Feeling</span><span class="value">"quiet presence": minimal information, no ticking ‚Äî just tactility and environmental aesthetics.</span></li>
            <li><span class="label">Role</span><span class="value">part of a daily ritual (like a cup of coffee) ‚Äî gently guides entry and exit from work.</span></li>
          </ul>
        </div>
      </div>
      <div class="analogy"><div class="atag">WHY ‚ÄúLOFI‚Äù</div>
        <p><strong>If Pomodoro is an aggressive fitness coach with a whistle,</strong> Focus Object is a vinyl record: you place the needle yourself (a conscious gesture), dive in, and return smoothly when the music fades.</p>
      </div>
    </div>

    <div class="slide content-slide" id="slide4">
      <div class="slide-number">04</div>
      <div>
        <h2>What‚Äôs next</h2>
        <p class="sub">Before we start with prototypes, here is a bit of context.</p>
      </div>
      <div class="flow-card">
        <div class="flow-grid">
          <div class="flow-left flow-left--center" style="grid-column:1;grid-row:1"><div class="flow-title flow-title--stacked"><span>Prototype</span><span>Review</span></div></div>
          <div class="flow-right" style="grid-column:3;grid-row:1"><div class="flow-copy">I'm working with a physical device for the first time. There‚Äôs no market research, production estimates, or guaranteed demand. There is design, philosophy, and my attempt to find a form that actually makes sense.<br><br>I want to walk the entrepreneur's path ‚Äî from idea to sale. That‚Äôs why your opinion matters: what looks <strong>real</strong> and what still feels like <strong>fantasy</strong>?</div></div>
          <div class="flow-left" style="grid-column:1;grid-row:2"><div class="flow-label">Pick 1</div></div>
          <div class="flow-right" style="grid-column:3;grid-row:2"><div class="flow-copy muted">At the end, choose your favorite. I take it to production (3D ‚Üí website ‚Üí ads) and come back with an update.</div></div>
          <div class="flow-mid" aria-hidden="true">
            <div class="flow-line"></div>
            <div class="flow-dot active top"></div>
            <div class="flow-dot active mid"></div>
            <div class="flow-dot bottom"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="slide image-only-slide" id="p01_photo1"><img class="full-bleed-img" src="" alt="Prototype 01 ‚Äî Render01" /></div>
    <div class="slide image-only-slide" id="p01_photo2"><img class="full-bleed-img" src="" alt="Prototype 01 ‚Äî Render02" /></div>
    <div class="slide image-only-slide" id="p01_photo3"><img class="full-bleed-img" src="" alt="Prototype 01 ‚Äî Render03" /></div>

    <div class="slide content-slide" id="p01_info">
      <div class="slide-number">05</div>
      <div><h2>Prototype 01</h2><p class="sub">First variant for testing. Later you'll choose a favorite.</p></div>
      <div class="proto-layout">
        <div class="panel accent">
          <div class="pk">VISUAL</div>
          <div class="pt">Render / Photo</div>
          <div class="hero proto-carousel" data-carousel="prototype01" aria-label="Prototype 01 images carousel">
            <button class="carousel-btn prev" type="button" aria-label="Previous image">‚Üê</button>
            <img class="carousel-img" src="" alt="Prototype 01 image" />
            <button class="carousel-btn next" type="button" aria-label="Next image">‚Üí</button>
            <div class="carousel-dots" aria-label="Select image"></div>
            <div class="carousel-count" aria-hidden="true"></div>
            <div class="carousel-fallback" aria-hidden="true">PLACEHOLDER IMAGES<br>image/slide-5/prototype1/Render01.png<br>Render02.png ‚Ä¢ Render03.png</div>
          </div>
          <div class="caption">Focus starts with a gesture, not with numbers</div>
        </div>
        <div class="panel">
          <div class="pk">WHAT DEFINES THIS PROTOTYPE</div>
          <div class="pt">Prototype overview</div>
          <ul class="plist">
            <li><strong>Positioning</strong> An object for a mindful entry into a work session. Used on the desk during individual, focused work.</li>
            <li><strong>Design</strong> An atypical timer form ‚Äî restrained and neutral. The main accent is not the screen, but the camera as the central element.</li>
            <li><strong>Control</strong> Session start happens via a gesture read by the camera. Time is set with a central rotary control.</li>
            <li><strong>Behavior</strong> Focus begins with a conscious gesture. The camera creates a sense of presence ‚Äî no distracting numbers, but a reminder that the process has started.</li>
          </ul>
          <div class="pchips"><div class="chip">Would you use an object like this in daily work?</div></div>
        </div>
      </div>
    </div>

    <div id="prototypesMount"></div>

    <div class="slide content-slide" id="final_pick">
      <div class="slide-number">15</div>
      <div>
        <h2>Pick your favorite</h2>
        <p class="sub">Choose one prototype and tell me why. Imagine you would actually buy one of them.</p>
      </div>

      <div class="pick-layout">
        <div class="pick-grid" id="pickGrid" aria-label="Pick prototype"></div>

        <div class="pick-panel">
          <div class="pk">SELECTED</div>
          <div class="pt" id="pickTitle">Prototype ‚Äî</div>

          <div class="pick-preview">
            <img id="pickPreviewImg" alt="Selected prototype preview" />
            <div class="pick-preview-fallback" id="pickPreviewFallback">Select a prototype to preview</div>
          </div>

          <div class="pick-actions">
            <div class="pk">FEEDBACK</div>
            <textarea id="pickText" class="pick-text" rows="5" spellcheck="false"></textarea>
            <div class="pick-btns">
              <button class="pick-btn" id="sendPickBtn" type="button">Send</button>
              <button class="pick-btn ghost" id="clearPickBtn" type="button">Clear</button>
            </div>
            <div class="pick-hint">You can change your choice until you find your option.</div>
          </div>
        </div>
      </div>
    </div>
    </div>
  </div>

  <div class="mini-counter"><span id="currentSlide">1</span> / <span id="totalSlides">1</span></div>

  <div class="slide-scrubber" id="slideScrubber">
    <input type="range" id="scrubberRange" min="1" max="1" step="1" value="1" aria-label="Slide scrubber" />
  </div>

  <div class="nav-buttons">
    <button class="nav-btn" id="prevBtn" type="button" aria-label="Previous slide">‚Üê</button>
    <button class="nav-btn" id="nextBtn" type="button" aria-label="Next slide">‚Üí</button>
  </div>

  <!-- =========================
       VIDEO ASSISTANT (PiP)
       ========================= -->
  <div class="pip" id="pip" aria-label="Video assistant" data-state="idle">
    <button class="pip-min" id="pipMin" type="button" aria-label="Minimize assistant"></button>

    <div class="pip-drag-handle" id="pipDragHandle" aria-hidden="true"></div>

    <div class="pip-hint" id="pipHint">Drag me</div>

    <div class="pip-inner" id="pipInner">
      <!-- iframe for Vimeo (loaded only after click Play) -->
      <iframe
        id="pipFrame"
        class="pip-frame"
        title="Slide narration"
        loading="lazy"
        allow="autoplay; fullscreen; picture-in-picture"
        referrerpolicy="strict-origin-when-cross-origin"
      ></iframe>

      <!-- Placeholder overlay -->
      <div class="pip-overlay" id="pipOverlay">
        <div class="pip-badge">EXPLAIN</div>
        <div class="pip-title" id="pipTitle">This slide</div>
        <div class="pip-sub" id="pipSub">Click Play to hear Dmytro‚Äôs note</div>
      </div>

      <div class="pip-controls floating" id="pipControls">
        <button class="pip-btn" id="pipPlay" type="button">Play</button>
        <button class="pip-btn ghost" id="pipStop" type="button" disabled>Reset</button>
      </div>
    </div>
  </div>

  <button class="pip-launch" id="pipLaunch" type="button" aria-label="Open assistant">
    !
  </button>

  <script src="https://player.vimeo.com/api/player.js"></script>
  <script>
  'use strict';

  const mobileMQ = window.matchMedia('(max-width: 900px)');
  const applyMobileClass = () => {
    if (!document.body) return;
    document.body.classList.toggle('is-mobile', mobileMQ.matches);
  };
  applyMobileClass();
  try { mobileMQ.addEventListener('change', applyMobileClass); } catch(e){}

  function updateScale(){
    const viewport = document.querySelector('.viewport');
    if (!viewport) return;

    const r = viewport.getBoundingClientRect();
    const vw = r.width;
    const vh = r.height;

    const stageW = 1920;
    const stageH = 1080;

    const isMobile = document.body && document.body.classList.contains('is-mobile');

    // –±–∞–∑–æ–≤–∏–π fit
    let scale = Math.min(vw / stageW, vh / stageH);

    // desktop: no upscaling, mobile: allow fill by width
    if (isMobile) {
      scale = vw / stageW;
    } else {
      scale = Math.min(1, scale); // FIX: no upscaling
    }

    document.documentElement.style.setProperty('--scale', String(scale));
  const base = isMobile ? 1.05 : 1.0; // –º–æ–±—ñ–ª—å–Ω–∞ –∫–æ–º–ø–µ–Ω—Å–∞—Ü—ñ—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ (–º–µ–Ω—à–∞, —â–æ–± –≤—Å–µ –≤–ª—ñ–∑–∞–ª–æ)
  const textComp = Math.min(isMobile ? 1.75 : 1.45, Math.max(isMobile ? 1.05 : 1, base / scale));
    document.documentElement.style.setProperty('--textCompSmall', String(textComp));
  }

  window.addEventListener('resize', () => requestAnimationFrame(updateScale));

  const pad2 = (n) => String(n).padStart(2, '0');

  const renderFileCandidates = (i) => {
    const base = `Render${pad2(i)}`;
    return [`${base}.png`, `${base}.jpg`, `${base}.jpeg`, `${base}.webp`, base];
  };

  const folderCandidates = (p) => [
    `image/slide-5/prototype${p}`,
    `image/slide-5/prototype${pad2(p)}`,
  ];

  const renderCandidates = (p, i) => {
    const files = renderFileCandidates(i);
    const folders = folderCandidates(p);
    const out = [];
    for (const f of folders) {
      for (const name of files) out.push(`${f}/${name}`);
    }
    return out;
  };

  const protoOverviewDefault = {
    items: [
      {
        label: 'Positioning',
        text: 'An object for a mindful entry into a work session. Used on the desk during individual, focused work.'
      },
      {
        label: 'Design',
        text: 'An atypical timer form ‚Äî restrained and neutral. The main accent is not the screen, but the camera as the central element.'
      },
      {
        label: 'Control',
        text: 'Session start happens via a gesture read by the camera. Time is set with a central rotary control.'
      },
      {
        label: 'Behavior',
        text: 'Focus begins with a conscious gesture. The camera creates a sense of presence ‚Äî no distracting numbers, but a reminder that the process has started.'
      }
    ],
    chip: 'Would you use an object like this in daily work?',
    caption: 'Focus starts with a gesture, not with numbers'
  };

  const protoOverviewByNumber = {
    2: {
      items: [
        {
          label: 'Positioning',
          text: 'A personal assistant for daily work and reflection. Accompanies you throughout the day and helps summarize focus, not just count time.'
        },
        {
          label: 'Design',
          text: 'A soft, friendly form with pleasant tactility. Looks like a personal object you want to keep close and take with you.'
        },
        {
          label: 'Control',
          text: 'A camera reads your daily routine in the background. Interaction happens through buttons and voice queries to a built-in assistant.'
        },
        {
          label: 'Behavior',
          text: 'Focus shifts from a ‚Äúsession start‚Äù to awareness of the day. The product not only starts work, but helps you understand how you work.'
        }
      ],
      chip: 'Would you need such an assistant in daily work?',
      caption: 'A personal assistant for focus and analysis'
    },
    3: {
      items: [
        {
          label: 'Positioning',
          text: 'A minimalist object for daily focus and working with routine. Used on the desk as a calm, aesthetic center of attention during individual work.'
        },
        {
          label: 'Design',
          text: 'A clean, restrained form with two key elements. The central rolling control references mechanical timers and alarm clocks. The display acts as a delicate reminder of the modern tech context.'
        },
        {
          label: 'Control',
          text: 'Time is set via a physical rolling control. It‚Äôs a slow, mindful action. After the timer starts, numbers fade into the background and remain only as a subtle reference.'
        },
        {
          label: 'Behavior',
          text: 'Focus shifts from counting time to the work process. Pixel art and lo‚Äëfi music support concentration. At the end of the day, the user sees the balance between Work and Chill sessions.'
        }
      ],
      chip: 'Would you want this object on your desk every day?',
      caption: 'Lo‚Äëfi object ‚Äî focus on the process'
    },
    4: {
      items: [
        {
          label: 'Positioning',
          text: 'A modular timer for public spaces. Designed for restaurants, studios, and entrepreneurial teams as a tool for waiting and shared time.'
        },
        {
          label: 'Design',
          text: 'A large object with an industrial character. The form resembles an assembled mechanism rather than a finished device. Visually it reads as part of the space, not a personal gadget.'
        },
        {
          label: 'Control',
          text: 'Time is set manually using a wrench. The user physically turns the mechanism that starts the countdown.'
        },
        {
          label: 'Behavior',
          text: 'Time becomes a tangible action rather than an abstract number. The start process turns into a gesture of participation and waiting, especially in a public context.'
        }
      ],
      chip: 'Would you see this object in a restaurant or workspace?',
      caption: 'Build your time'
    },
    5: {
      items: [
        {
          label: 'Positioning',
          text: 'A visual timer for focused work. Placed on the desk and lets you sense the flow of time without constant attention to digits.'
        },
        {
          label: 'Design',
          text: 'A technologically clean form with an emphasis on a light ring. The red emission acts as the only visual time signal. The design departs from classic timers and alarm clocks.'
        },
        {
          label: 'Control',
          text: 'Time is set by rotating the central element. After start, no interaction is needed. The timer works as a calm background indicator.'
        },
        {
          label: 'Behavior',
          text: 'Time is read visually, not consciously counted. The absence of digits reduces pressure and lets you stay in the process while watching time gradually pass.'
        }
      ],
      chip: 'Would you be comfortable working with a visual timer without numbers?',
      caption: 'Tech style timer'
    },
    6: {
      items: [
        {
          label: 'Positioning',
          text: 'A timer-lamp for work and home spaces. Combines time control with lighting that complements the interior and doesn‚Äôt distract from work.'
        },
        {
          label: 'Design',
          text: 'A lamp form with a soft light volume. The object looks like part of the interior, not a technical device. Light is the primary information carrier.'
        },
        {
          label: 'Control',
          text: 'Time and mode are set via physical interaction with the object. Light changes according to the chosen session and gradually responds to the passage of time.'
        },
        {
          label: 'Behavior',
          text: 'Time is read through light, not digits. Work and Chill sessions have different light atmospheres, helping you switch states without sharp signals.'
        }
      ],
      chip: 'Would you use a timer in a lamp format every day?',
      caption: 'Adjust your light ‚Äî adjust your time'
    },
    7: {
      items: [
        {
          label: 'Positioning',
          text: 'A background timer for focus and rest. Works as visual accompaniment to the work process and complements the interior rather than competing with it.'
        },
        {
          label: 'Design',
          text: 'A form with a pixel‚Äëart screen. The visual is inspired by fireplace background videos and a lo‚Äëfi atmosphere. The object looks decorative and calm even while idle.'
        },
        {
          label: 'Control',
          text: 'Work and Chill modes are enabled via top buttons. Time is set by physical scrolling, without complex settings.'
        },
        {
          label: 'Behavior',
          text: 'The fireplace on the screen works as a background time signal. It creates a sense of presence and rhythm without distracting numbers or sharp alerts.'
        }
      ],
      chip: 'Would you want a background timer like this in your workspace?',
      caption: 'Digital fireplace'
    },
    8: {
      items: [
        {
          label: 'Positioning',
          text: 'A companion object for mindful work. Used on the desk as a visual presence that supports focus and discipline.'
        },
        {
          label: 'Design',
          text: 'An anthropomorphic form inspired by rubber duck debugging. The object looks friendly and a bit naive, yet creates a sense that you are being watched.'
        },
        {
          label: 'Control',
          text: 'The timer starts through physical interaction with the object. To begin a session, you stand it upright. When time ends, the object drops and loses its shape.'
        },
        {
          label: 'Behavior',
          text: 'The object‚Äôs presence increases accountability for focus. To continue working, the user must consciously straighten it again. Focus is supported not by signals but by a behavioral action.'
        }
      ],
      chip: 'Would an object like this help you stay focused longer?',
      caption: 'Friend Duck concept'
    },
    9: {
      items: [
        {
          label: 'Positioning',
          text: 'An interactive timer for creative and focused computer work. Used on the desk as a visual companion during active work.'
        },
        {
          label: 'Design',
          text: 'A compact desk object with a screen for generative visuals. The design is neutral so it doesn‚Äôt compete with content. The main focus is what happens on the screen in real time.'
        },
        {
          label: 'Control',
          text: 'The timer starts together with a program on the computer. During a session the device receives data from the camera, screen, or active apps and sends it to TouchDesigner.'
        },
        {
          label: 'Behavior',
          text: 'Work actions turn into living generative visuals. Motion, activity, and user presence affect what is displayed. The timer encourages action rather than waiting for the countdown to end.'
        }
      ],
      chip: 'Would it motivate you to work if your actions became a live visual process?',
      caption: 'TouchDesigner concept'
    },
    10: {
      items: [
        {
          label: 'Positioning',
          text: 'An art object for mindful focus. Works on the desk as a quiet presence, not a time-control tool.'
        },
        {
          label: 'Design',
          text: 'A monolithic, restrained form without decorative elements. The object looks like a sculpture or interior element. The design is intentionally not tied to a timer image.'
        },
        {
          label: 'Control',
          text: 'Time is set once at the start of a session. The user does not interact with the object during work and receives no additional signals.'
        },
        {
          label: 'Behavior',
          text: 'Time is not shown in digits. The session‚Äôs flow is read through the movement of a black square that slowly descends. Work happens without a countdown and without the tension of waiting.'
        }
      ],
      chip: 'Would you be comfortable with a timer that doesn‚Äôt show time directly?',
      caption: 'Focus without digits and signals'
    }
  };

  function setImgWithFallback(imgEl, candidates, opts) {
    if (!imgEl) return;
    const options = opts && typeof opts === 'object' ? opts : {};
    const list = (Array.isArray(candidates) ? candidates : []).filter(Boolean);
    let idx = 0;

    const tryNext = () => {
      if (idx >= list.length) {
        if (typeof options.onFail === 'function') options.onFail();
        return;
      }
      imgEl.src = list[idx++];
    };

    imgEl.onerror = () => tryNext();
    tryNext();
  }

  function setSmartCrop(imgEl){
    if (!imgEl || !imgEl.naturalWidth || !imgEl.naturalHeight) return;
    const r = imgEl.naturalWidth / imgEl.naturalHeight;

    // —è–∫—â–æ –±–ª–∏–∑—å–∫–æ –¥–æ 16:10 (2400x1500)
    if (Math.abs(r - (16/10)) < 0.03){
      imgEl.style.setProperty('--crop-y', '42%'); // —Ç—Ä–æ—Ö–∏ –≤–∏—â–µ —Ü–µ–Ω—Ç—Ä—É
      imgEl.style.setProperty('--crop-x', '50%');
    }
  }

  let currentSlide = 1;

  const getSlides = () => Array.from(document.querySelectorAll('.slide'));

  const setCounter = (t) => {
    const el = document.getElementById('totalSlides');
    if (el) el.textContent = String(t);
  };

  const setCurrent = (n) => {
    const el = document.getElementById('currentSlide');
    if (el) el.textContent = String(n);
  };

  const setButtons = (t) => {
    const p = document.getElementById('prevBtn');
    const n = document.getElementById('nextBtn');
    if (p) p.disabled = currentSlide === 1;
    if (n) n.disabled = currentSlide === t;
  };

  function syncScrubber(total) {
    const range = document.getElementById('scrubberRange');
    if (range) {
      range.max = String(total);
      range.value = String(currentSlide);
    }
  }

  function showSlide(n) {
    const slides = getSlides();
    const total = slides.length;
    if (!total) return;

    const safe = Math.max(1, Math.min(n, total));
    slides.forEach((s) => s.classList.remove('active'));

    const target = slides[safe - 1];
    if (!target) return;
    target.classList.add('active');

    const slide4 = document.getElementById('slide4');
    if (slide4) {
      slide4.classList.remove('animate-line');
      void slide4.offsetWidth;
    }
    if (target.id === 'slide4' && slide4) slide4.classList.add('animate-line');

    // PiP assistant slide sync
    if (window.__pipSetSlide && target && target.id) {
      window.__pipSetSlide(target.id);
    }

    currentSlide = safe;
    setCurrent(currentSlide);
    setCounter(total);
    setButtons(total);
    syncScrubber(total);
  }

  function bindNav() {
    const prev = document.getElementById('prevBtn');
    const next = document.getElementById('nextBtn');
    const scrubber = document.getElementById('slideScrubber');

    if (prev) prev.addEventListener('click', () => showSlide(currentSlide - 1));
    if (next) next.addEventListener('click', () => showSlide(currentSlide + 1));

    document.addEventListener('keydown', (e) => {
      const active = document.activeElement;
      const inCarousel = active && active.closest && active.closest('.proto-carousel');
      const inInput = active && active.tagName === 'INPUT';
      if (inCarousel || inInput) return;
      if (e.key === 'ArrowLeft') showSlide(currentSlide - 1);
      if (e.key === 'ArrowRight') showSlide(currentSlide + 1);
    });

    let wheelAccum = 0;
    let wheelRaf = 0;

    const applyWheelDelta = (delta) => {
      wheelAccum += delta;
      if (wheelRaf) return;
      wheelRaf = requestAnimationFrame(() => {
        const stepSize = 100;
        const stepsRaw = Math.trunc(wheelAccum / stepSize);
        const steps = Math.max(-4, Math.min(4, stepsRaw));
        if (steps !== 0) {
          showSlide(currentSlide + steps);
          wheelAccum -= steps * stepSize;
        }
        wheelRaf = 0;
      });
    };

    const range = document.getElementById('scrubberRange');
    if (range) {
      let raf = 0;
      range.addEventListener('input', () => {
        const v = Number(range.value);
        if (!Number.isFinite(v)) return;
        if (raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(() => showSlide(v));
      });

      range.addEventListener('wheel', (e) => {
        e.preventDefault();
        applyWheelDelta(e.deltaY);
      }, { passive: false });
    }

    if (scrubber) {
      scrubber.addEventListener('wheel', (e) => {
        e.preventDefault();
        applyWheelDelta(e.deltaY);
      }, { passive: false });
    }

    document.addEventListener('wheel', (e) => {
      const target = e.target;
      const inInput = target && (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.isContentEditable);
      const inCarousel = target && target.closest && target.closest('.proto-carousel');
      if (inInput || inCarousel) return;

      e.preventDefault();
      applyWheelDelta(e.deltaY);
    }, { passive: false });
  }

  const makeId = (p, kind) => `p${pad2(p)}_${kind}`;
  const infoNum = (p) => String(4 + p).padStart(2, '0');

  function protoPhoto(p, i) {
    const slide = document.createElement('div');
    slide.className = 'slide image-only-slide';
    slide.id = makeId(p, `photo${i}`);

    const img = document.createElement('img');
    img.className = 'full-bleed-img';
    img.alt = `Prototype ${pad2(p)} ‚Äî Render${pad2(i)}`;
    slide.appendChild(img);

    const ph = document.createElement('div');
    ph.className = 'img-missing';
    ph.style.display = 'flex';
    const firstGuess = `${folderCandidates(p)[0]}/Render${pad2(i)}.png`;
    ph.innerHTML =
      `<div class="tag">Missing image</div>` +
      `<div class="hint">Couldn‚Äôt find the file for <strong>Prototype ${pad2(p)}</strong>, frame <strong>${i}</strong>.<br>Check the path/name (including extension).</div>` +
      `<code>${firstGuess}</code>`;
    slide.appendChild(ph);

    return slide;
  }

  function protoInfo(p) {
    const label = pad2(p);
    const slide = document.createElement('div');
    slide.className = 'slide content-slide';
    slide.id = makeId(p, 'info');

    const folderHint = folderCandidates(p)[0];
    const overview = protoOverviewByNumber[p] || protoOverviewDefault;
    const overviewList = (overview.items || [])
      .map((item) => `<li><strong>${item.label}</strong> ${item.text}</li>`)
      .join('');
    const overviewChip = overview.chip ? `<div class="chip">${overview.chip}</div>` : '';
    const overviewCaption = overview.caption || protoOverviewDefault.caption || '';

    slide.innerHTML =
      `<div class="slide-number">${infoNum(p)}</div>` +
      `<div><h2>Prototype ${label}</h2><p class="sub">Test variant. At the end, you choose a favorite.</p></div>` +
      `<div class="proto-layout">` +
        `<div class="panel accent">` +
          `<div class="pk">VISUAL</div><div class="pt">Render / Photo</div>` +
          `<div class="hero proto-carousel" data-carousel="prototype${label}" aria-label="Prototype ${label} images carousel">` +
            `<button class="carousel-btn prev" type="button" aria-label="Previous image">‚Üê</button>` +
            `<img class="carousel-img" src="" alt="Prototype ${label} image" />` +
            `<button class="carousel-btn next" type="button" aria-label="Next image">‚Üí</button>` +
            `<div class="carousel-dots" aria-label="Select image"></div>` +
            `<div class="carousel-count" aria-hidden="true"></div>` +
            `<div class="carousel-fallback" aria-hidden="true">PLACEHOLDER IMAGES<br>${folderHint}/Render01.png<br>Render02.png ‚Ä¢ Render03.png</div>` +
          `</div>` +
          `<div class="caption">${overviewCaption}</div>` +
        `</div>` +
        `<div class="panel">` +
          `<div class="pk">WHAT DEFINES THIS PROTOTYPE</div><div class="pt">Prototype overview</div>` +
          `<ul class="plist">` +
            `${overviewList}` +
          `</ul>` +
          `<div class="pchips">` +
            `${overviewChip}` +
          `</div>` +
        `</div>` +
      `</div>`;

    return slide;
  }

  function inject02to10() {
    const mount = document.getElementById('prototypesMount');
    if (!mount) return;

    const frag = document.createDocumentFragment();
    for (let p = 2; p <= 10; p++) {
      frag.appendChild(protoPhoto(p, 1));
      frag.appendChild(protoPhoto(p, 2));
      frag.appendChild(protoPhoto(p, 3));
      frag.appendChild(protoInfo(p));
    }

    mount.replaceChildren(frag);
  }

  function parseProtoNumFromKey(key) {
    const m = String(key || '').match(/^prototype([0-9]{1,2})$/);
    if (!m) return null;
    return Number(m[1]);
  }

  function initCarousels() {
    const els = Array.from(document.querySelectorAll('.proto-carousel[data-carousel]'));

    els.forEach((el) => {
      const key = el.getAttribute('data-carousel') || '';
      const protoNum = parseProtoNumFromKey(key);

      const img = el.querySelector('.carousel-img');
      const fallback = el.querySelector('.carousel-fallback');
      const dots = el.querySelector('.carousel-dots');
      const counter = el.querySelector('.carousel-count');
      const prev = el.querySelector('.carousel-btn.prev');
      const next = el.querySelector('.carousel-btn.next');

      let index = 0;

      const showFallback = (v) => {
        if (fallback) fallback.style.display = v ? 'flex' : 'none';
        if (img) img.style.opacity = v ? '0' : '1';
      };

      const setCount = () => {
        if (counter) counter.textContent = `${(index % 3) + 1} / 3`;
      };

      const buildDots = () => {
        if (!dots) return;
        dots.innerHTML = '';
        for (let i = 0; i < 3; i++) {
          const b = document.createElement('button');
          b.type = 'button';
          b.className = 'carousel-dot' + (i === (index % 3) ? ' active' : '');
          b.setAttribute('aria-label', `Go to image ${i + 1}`);
          b.addEventListener('click', (ev) => {
            ev.stopPropagation();
            setIndex(i);
          });
          dots.appendChild(b);
        }
      };

      function candidatesForLogical(logicalIndex) {
        if (!protoNum) return [];
        return renderCandidates(protoNum, (logicalIndex % 3) + 1);
      }

      function setIndex(newLogical) {
        index = (newLogical + 3) % 3;
        buildDots();
        setCount();

        const candidates = candidatesForLogical(index);
        if (!img || candidates.length === 0) {
          showFallback(true);
          if (prev) prev.disabled = true;
          if (next) next.disabled = true;
          return;
        }

        if (prev) prev.disabled = false;
        if (next) next.disabled = false;

        const tmp = new Image();
        let ci = 0;

        const tryNext = () => {
          if (ci >= candidates.length) {
            showFallback(true);
            return;
          }
          const src = candidates[ci++];
          tmp.onload = () => {
            img.src = src;
            img.alt = `${key} image ${index + 1}`;
            showFallback(false);
            img.onload = () => setSmartCrop(img);
          };
          tmp.onerror = () => tryNext();
          tmp.src = src;
        };

        tryNext();
      }

      if (prev) prev.addEventListener('click', (ev) => {
        ev.stopPropagation();
        setIndex(index - 1);
      });

      if (next) next.addEventListener('click', (ev) => {
        ev.stopPropagation();
        setIndex(index + 1);
      });

      el.addEventListener('click', () => setIndex(index + 1));

      el.setAttribute('tabindex', '0');
      el.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') {
          e.preventDefault();
          e.stopPropagation();
          setIndex(index - 1);
        }
        if (e.key === 'ArrowRight') {
          e.preventDefault();
          e.stopPropagation();
          setIndex(index + 1);
        }
      });

      setIndex(0);
    });
  }

  function ensureMissingOverlay(slide, protoNum, idx) {
    if (!slide) return null;

    let ph = slide.querySelector('.img-missing');
    if (ph) return ph;

    ph = document.createElement('div');
    ph.className = 'img-missing';
    ph.style.display = 'none';

    const protoLabel = pad2(protoNum);
    const fileLabel = `Render${pad2(idx)}`;
    const firstGuess = `${folderCandidates(protoNum)[0]}/${fileLabel}.png`;

    ph.innerHTML =
      `<div class="tag">Missing image</div>` +
      `<div class="hint">Couldn‚Äôt find the file for <strong>Prototype ${protoLabel}</strong>, frame <strong>${idx}</strong>.<br>Check the path/name (including extension).</div>` +
      `<code>${firstGuess}</code>`;

    slide.appendChild(ph);
    return ph;
  }

  function hydrateFullscreenPrototypeImages() {
    const imgs = Array.from(document.querySelectorAll('.image-only-slide img.full-bleed-img'));

    imgs.forEach((img) => {
      const slide = img.closest && img.closest('.slide');
      const id = slide && slide.id ? String(slide.id) : '';
      const m = id.match(/^p([0-9]{2})_?photo([0-9])$/);
      if (!m) return;

      const protoNum = Number(m[1]);
      const idx = Number(m[2]);
      if (!Number.isFinite(protoNum) || !Number.isFinite(idx)) return;

      if (slide) slide.style.background = '#0b0b0b';

      const ph = ensureMissingOverlay(slide, protoNum, idx);
      if (ph) ph.style.display = 'flex';

      const candidates = renderCandidates(protoNum, idx);

      img.onload = () => {
        if (ph) ph.style.display = 'none';
        setSmartCrop(img);
      };

      setImgWithFallback(img, candidates, {
        onFail: () => {
          if (ph) ph.style.display = 'flex';
        },
      });
    });
  }

  function hydratePrototype01StaticPhotos() {
    for (let i = 1; i <= 3; i++) {
      const slide = document.getElementById(`p01_photo${i}`);
      if (!slide) continue;
      const img = slide.querySelector('img.full-bleed-img');
      if (!img) continue;

      const ph = ensureMissingOverlay(slide, 1, i);
      if (ph) ph.style.display = 'flex';

      setImgWithFallback(img, renderCandidates(1, i), {
        onFail: () => {
          if (ph) ph.style.display = 'flex';
        },
      });

      img.onload = () => {
        if (ph) ph.style.display = 'none';
        setSmartCrop(img);
      };
    }
  }

  function runSelfTests() {
    console.groupCollapsed('[Focus] self-tests');

    console.assert(Array.isArray(folderCandidates(2)), 'folderCandidates(2) must return an array');
    console.assert(folderCandidates(2)[0] === 'image/slide-5/prototype2', 'prototype2 path should be first candidate');

    const rc = renderCandidates(2, 1);
    console.assert(rc.length >= 5, 'renderCandidates should provide multiple fallbacks');
    console.assert(rc[0].includes('prototype2') && rc[0].includes('Render01'), 'first render candidate should target prototype2/Render01');

    const slides = getSlides();
    console.assert(slides.length >= 7, 'slides should include base + prototype slides (expected >= 7)');

    const range = document.getElementById('scrubberRange');
    console.assert(!!range, 'scrubber element must exist');

    console.groupEnd();
  }

  function initFinalPicker(){
    const grid = document.getElementById('pickGrid');
    const title = document.getElementById('pickTitle');
    const previewImg = document.getElementById('pickPreviewImg');
    const previewFallback = document.getElementById('pickPreviewFallback');
    const text = document.getElementById('pickText');
    const sendBtn = document.getElementById('sendPickBtn');
    const clearBtn = document.getElementById('clearPickBtn');

    if (!grid || !title || !previewImg || !previewFallback || !text) return;

    const keyLS = 'focus_pick_proto';
    let selected = Number(localStorage.getItem(keyLS) || 0);

    const protoLabel = (p) => `Prototype ${String(p).padStart(2,'0')}`;

    const makeFeedback = (p) => {
      const label = protoLabel(p);
      return [
        `Why this prototype?`,
        `What works for you, and what would you change?`,
      ].join('\n');
    };

    const setSelectedUI = (p) => {
      selected = p;

      // highlight cards
      const cards = Array.from(grid.querySelectorAll('.pick-card'));
      cards.forEach(c => c.classList.toggle('selected', Number(c.dataset.p) === p));

      // right panel title + text
      title.textContent = protoLabel(p);
      text.value = makeFeedback(p);

      // preview image (Render01)
      previewFallback.style.display = 'flex';
      previewImg.style.opacity = '0';

      const candidates = renderCandidates(p, 1);
      setImgWithFallback(previewImg, candidates, {
        onFail: () => {
          previewFallback.textContent = 'Preview image not found';
          previewFallback.style.display = 'flex';
          previewImg.style.opacity = '0';
        }
      });

      previewImg.onload = () => {
        previewFallback.style.display = 'none';
        previewImg.style.opacity = '1';
        setSmartCrop(previewImg);
      };

      // persist
      try { localStorage.setItem(keyLS, String(p)); } catch(e){}
    };

    // build grid cards 1..10
    grid.innerHTML = '';
    for (let p = 1; p <= 10; p++){
      const card = document.createElement('div');
      card.className = 'pick-card';
      card.dataset.p = String(p);

      const thumb = document.createElement('div');
      thumb.className = 'pick-thumb';

      const img = document.createElement('img');
      img.alt = `${protoLabel(p)} thumbnail`;
      thumb.appendChild(img);

      // thumb image (Render01)
      setImgWithFallback(img, renderCandidates(p, 1), {
        onFail: () => { /* –∑–∞–ª–∏—à–∏—Ç—å—Å—è –ø—É—Å—Ç–∏–π thumb */ }
      });

      const meta = document.createElement('div');
      meta.className = 'pick-meta';
      meta.innerHTML = `
        <div class="name">${protoLabel(p)}</div>
        <div class="desc">Click to select</div>
      `;

      card.appendChild(thumb);
      card.appendChild(meta);

      card.addEventListener('click', () => setSelectedUI(p));
      grid.appendChild(card);
    }

    // buttons
    if (sendBtn){
      sendBtn.addEventListener('click', () => {
        const msg = String(text.value || '').trim();
        if (!msg) return;

        const proto = String(title.textContent || 'Prototype ‚Äî').trim();
        const full = `${proto}\n\n${msg}`;

        const tgApp = `tg://resolve?domain=dima_gavriliv&text=${encodeURIComponent(full)}`;
        const tgWeb = `https://t.me/dima_gavriliv?text=${encodeURIComponent(full)}`;

        window.location.href = tgApp;
        setTimeout(() => window.open(tgWeb, '_blank'), 300);
      });
    }

    if (clearBtn){
      clearBtn.addEventListener('click', () => {
        selected = 0;
        try { localStorage.removeItem(keyLS); } catch(e){}
        const cards = Array.from(grid.querySelectorAll('.pick-card'));
        cards.forEach(c => c.classList.remove('selected'));
        title.textContent = 'Prototype ‚Äî';
        text.value = '';
        previewFallback.textContent = 'Select a prototype to preview';
        previewFallback.style.display = 'flex';
        previewImg.style.opacity = '0';
        previewImg.removeAttribute('src');
      });
    }

    // restore previous selection
    if (Number.isFinite(selected) && selected >= 1 && selected <= 10){
      setSelectedUI(selected);
    } else {
      // default: none selected
      title.textContent = 'Prototype ‚Äî';
      text.value = '';
    }
  }

  /* =========================
     VIDEO ASSISTANT (PiP) JS
     ========================= */

  const vimeoParams = '?autoplay=1&autopause=0&controls=0&title=0&byline=0&portrait=0&badge=0&dnt=1';
  const vimeoUrl = (id) => `https://player.vimeo.com/video/${id}${vimeoParams}`;

  const slideNarration = {
    slide1: vimeoUrl('1163977015'),
    slide2: vimeoUrl('1163977221'),
    slide3: vimeoUrl('1163977451'),
    slide4: vimeoUrl('1163977689'),

    p01_info: vimeoUrl('1163977999'),
    p02_info: vimeoUrl('1163978367'),
    p03_info: vimeoUrl('1163978626'),
    p04_info: vimeoUrl('1163978858'),
    p05_info: vimeoUrl('1163979021'),
    p06_info: vimeoUrl('1163979197'),
    p07_info: vimeoUrl('1163979281'),
    p08_info: vimeoUrl('1163979390'),
    p09_info: vimeoUrl('1163979593'),
    p10_info: vimeoUrl('1163979965'),
    final_pick: vimeoUrl('1163980101'),
  };

  // 2) –¢–µ–∫—Å—Ç–∏ –¥–ª—è placeholder (—â–æ–± –≤–∏–≥–ª—è–¥–∞–ª–æ ‚Äú–∂–∏–≤—ñ—à–µ‚Äù)
  const slideTitles = {
    slide1: 'Intro / What is this?',
    slide2: 'Visual Context',
    slide3: 'Product Concept',
    slide4: "What‚Äôs next",
    p01_info: 'Prototype 01',
    p02_info: 'Prototype 02',
    p03_info: 'Prototype 03',
    p04_info: 'Prototype 04',
    p05_info: 'Prototype 05',
    p06_info: 'Prototype 06',
    p07_info: 'Prototype 07',
    p08_info: 'Prototype 08',
    p09_info: 'Prototype 09',
    p10_info: 'Prototype 10',
    final_pick: 'Pick your favorite',
  };

  function initPiPAssistant(){
    const pip = document.getElementById('pip');
    const pipInner = document.getElementById('pipInner');
    let pipFrame = document.getElementById('pipFrame');
    const pipOverlay = document.getElementById('pipOverlay');
    const pipTitle = document.getElementById('pipTitle');
    const pipSub = document.getElementById('pipSub');
    const pipPlay = document.getElementById('pipPlay');
    const pipStop = document.getElementById('pipStop');
    const pipMin = document.getElementById('pipMin');
    const pipLaunch = document.getElementById('pipLaunch');

    if (!pip || !pipInner || !pipFrame || !pipOverlay || !pipTitle || !pipSub || !pipPlay || !pipStop || !pipMin || !pipLaunch) return;

    const LS_KEY = 'focus_pip_pos';
    const MIN_KEY = 'focus_pip_minimized_v1';

    let activeSlideId = null;
    let isDragging = false;
    let dragStart = { x: 0, y: 0 };
    let pipStart = { x: 0, y: 0 };

    // helper: get viewport bounds and clamp
    const clamp = (v, a, b) => Math.max(a, Math.min(v, b));

    const getPos = () => {
      const rect = pip.getBoundingClientRect();
      return { x: rect.left, y: rect.top, w: rect.width, h: rect.height };
    };

    const setPos = (x, y) => {
      pip.style.left = `${x}px`;
      pip.style.top = `${y}px`;
      pip.style.right = 'auto';
      pip.style.bottom = 'auto';
    };

    const savePos = () => {
      const p = getPos();
      try { localStorage.setItem(LS_KEY, JSON.stringify({ x: p.x, y: p.y })); } catch(e){}
    };

    const restorePos = () => {
      try{
        const raw = localStorage.getItem(LS_KEY);
        if (!raw) return;
        const data = JSON.parse(raw);
        if (!data || typeof data.x !== 'number' || typeof data.y !== 'number') return;

        // clamp on restore
        const p = getPos();
        const maxX = window.innerWidth - p.w - 10;
        const maxY = window.innerHeight - p.h - 10;
        setPos(clamp(data.x, 10, maxX), clamp(data.y, 10, maxY));
      }catch(e){}
    };

    const setMinimized = (v) => {
      try { localStorage.setItem(MIN_KEY, v ? '1' : '0'); } catch(e){}
      pip.classList.toggle('is-minimized', v);
      pipLaunch.classList.toggle('is-visible', v);
    };

    const restoreMinState = () => {
      let isMin = false;
      try { isMin = localStorage.getItem(MIN_KEY) === '1'; } catch(e){}
      setMinimized(isMin);
    };

    // Vimeo player instance
    let vimeoPlayer = null;
    let isPaused = true;

    const bindVimeoEvents = (player) => {
      if (!player || typeof player.on !== 'function') return;

      player.on('ended', async () => {
        try {
          await player.setCurrentTime(0);
          await player.pause();
        } catch(e){}

        isPaused = true;
        setPlayLabel();
        pip.dataset.state = 'ready';
      });
    };

    // ‚úÖ token to prevent async race (Reset -> Play)
    let actionSeq = 0;
    const nextAction = () => ++actionSeq;

    const setPlayLabel = () => {
      pipPlay.textContent = isPaused ? 'Play' : 'Pause';
    };

    const tryUnmute = async () => {
      if (!vimeoPlayer) return;
      try {
        await vimeoPlayer.setMuted(false);
        await vimeoPlayer.setVolume(1);
      } catch(e) {}
    };

    const recreatePipFrame = () => {
      // —Ä–æ–±–∏–º–æ –Ω–æ–≤–∏–π iframe –∑ —Ç–∏–º–∏ –∂ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ (–≤–∞–∂–ª–∏–≤–æ –¥–ª—è Vimeo SDK)
      const fresh = document.createElement('iframe');
      fresh.id = 'pipFrame';
      fresh.className = 'pip-frame';
      fresh.title = 'Slide narration';
      fresh.loading = 'lazy';
      fresh.allow = 'autoplay; fullscreen; picture-in-picture';
      fresh.setAttribute('allowfullscreen', '');
      fresh.referrerPolicy = 'strict-origin-when-cross-origin';

      // –∑–∞–º—ñ–Ω—è—î–º–æ –≤ DOM
      if (pipFrame && pipFrame.parentNode) {
        pipFrame.replaceWith(fresh);
      } else {
        pipInner.prepend(fresh);
      }
      pipFrame = fresh; // ‚úÖ –æ–Ω–æ–≤–∏–ª–∏ ref
    };

    // video state helpers
    const stopVideo = async () => {
      const mySeq = nextAction();

      pip.dataset.state = 'idle';

      const playerToStop = vimeoPlayer;
      vimeoPlayer = null;

      // ‚úÖ –≤–∞–∂–ª–∏–≤–æ: –ø—Ä–∏–±–∏—Ä–∞—î–º–æ —Å—Ç–∞—Ä–∏–π player –ø—Ä–∞–≤–∏–ª—å–Ω–æ
      try { if (playerToStop) await playerToStop.destroy(); } catch(e){}

      // ‚úÖ –≤–∞–∂–ª–∏–≤–æ: —Ä–æ–±–∏–º–æ —á–∏—Å—Ç–∏–π iframe (—ñ–Ω–∞–∫—à–µ Vimeo –º–æ–∂–µ ‚Äú–∑–∞–ª–∏–ø–∞—Ç–∏‚Äù)
      recreatePipFrame();

      isPaused = true;
      setPlayLabel();

      pipPlay.disabled = false;
      pipStop.disabled = true;
      pipOverlay.style.pointerEvents = 'none';

      if (mySeq !== actionSeq) return;
    };

    const togglePlayPause = async () => {
      const mySeq = nextAction();

      const url = slideNarration[activeSlideId] || null;

      if (!url){
        pipSub.textContent = 'Coming soon ‚Äî add Vimeo link for this slide';
        pip.animate([{ transform:'scale(1)' }, { transform:'scale(1.02)' }, { transform:'scale(1)' }], { duration: 280 });
        return;
      }

      // If not loaded yet -> load and play
      if (!pipFrame.getAttribute('src')) {
        pipFrame.src = url;
        pip.dataset.state = 'playing';
        pipStop.disabled = false;

        vimeoPlayer = new Vimeo.Player(pipFrame);
        bindVimeoEvents(vimeoPlayer);

        try {
          // ‚úÖ —á–µ–∫–∞—î–º–æ, –ø–æ–∫–∏ Vimeo —Ä–µ–∞–ª—å–Ω–æ –ø—ñ–¥ º—î–¥–Ω–∞—î—Ç—å—Å—è –¥–æ iframe
          await vimeoPlayer.ready();
          await tryUnmute();
          await vimeoPlayer.play();
        } catch(e){
          // —è–∫—â–æ play –Ω–µ –≤–¥–∞–≤—Å—è ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ UI –≤ "Play"
          if (mySeq !== actionSeq) return;
          isPaused = true;
          setPlayLabel();
          return;
        }

        if (mySeq !== actionSeq) return;

        isPaused = false;
        setPlayLabel();
        return;
      }

      if (!vimeoPlayer) {
        vimeoPlayer = new Vimeo.Player(pipFrame);
        bindVimeoEvents(vimeoPlayer);
      }

      try {
        await vimeoPlayer.ready();

        if (isPaused) {
          await tryUnmute();
          await vimeoPlayer.play();
          if (mySeq !== actionSeq) return;
          isPaused = false;
        } else {
          await vimeoPlayer.pause();
          if (mySeq !== actionSeq) return;
          isPaused = true;
        }
      } catch(e){
        // —è–∫—â–æ —â–æ—Å—å –∑–ª–∞–º–∞–ª–æ—Å—å ‚Äî –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö—É—î–º–æ—Å—å
        if (mySeq !== actionSeq) return;
        isPaused = true;
      }

      if (mySeq !== actionSeq) return;
      setPlayLabel();
    };

    // update placeholder per slide
    const setSlideContext = (slideId) => {
      activeSlideId = slideId;

      const shouldBrighten = /^p\d{2}_info$/.test(String(slideId || '')) || slideId === 'final_pick';
      pip.classList.toggle('is-brightened', shouldBrighten);

      const nice = slideTitles[slideId] || slideId || 'This slide';
      pipTitle.textContent = nice;

      const has = !!slideNarration[slideId];
      pipSub.textContent = has
        ? 'Click Play to hear Dmytro‚Äôs note'
        : 'No video yet ‚Äî you can add it later (Vimeo)';

      // –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Å–ª–∞–π–¥—É ‚Äî —Å—Ç–æ–ø–∞—î–º–æ –≤—ñ–¥–µ–æ (—â–æ–± –Ω–µ –≥–æ–≤–æ—Ä–∏–ª–æ –Ω–µ –≤ —Ç–µ–º—É)
      (async () => {
        await stopVideo();
        isPaused = true;
        setPlayLabel();
      })();

      // ‚úÖ Hide PiP on image-only slides (full-screen photos)
      const slideEl = document.getElementById(slideId);
      const isPhotoSlide = !!(slideEl && slideEl.classList && slideEl.classList.contains('image-only-slide'));

      if (isPhotoSlide){
        // stop + fully hide (no PiP, no launcher)
        stopVideo();
        pip.classList.add('is-suppressed');
        pipLaunch.classList.add('is-suppressed');
        return;
      }

      // back to normal slides
      pip.classList.remove('is-suppressed');
      pipLaunch.classList.remove('is-suppressed');

      // restore minimized state (what user chose)
      restoreMinState();
    };

    // drag logic (ignore clicks on buttons)
    const isInteractiveTarget = (el) => {
      if (!el) return false;
      return !!el.closest('button') || el.tagName === 'IFRAME' || !!el.closest('textarea') || !!el.closest('input');
    };

    const isDragHandle = (el) => {
      if (!el) return false;
      return !!el.closest('.pip-drag-handle');
    };

    const onPointerDown = (e) => {
      if (!isDragHandle(e.target)) return;
      if (isInteractiveTarget(e.target)) return;

      isDragging = true;
      pip.setPointerCapture(e.pointerId);

      const p = getPos();
      pipStart = { x: p.x, y: p.y };
      dragStart = { x: e.clientX, y: e.clientY };
    };

    const onPointerMove = (e) => {
      if (!isDragging) return;
      const dx = e.clientX - dragStart.x;
      const dy = e.clientY - dragStart.y;

      const p = getPos();
      const maxX = window.innerWidth - p.w - 10;
      const maxY = window.innerHeight - p.h - 10;

      const nx = clamp(pipStart.x + dx, 10, maxX);
      const ny = clamp(pipStart.y + dy, 10, maxY);

      setPos(nx, ny);
    };

    const onPointerUp = () => {
      if (!isDragging) return;
      isDragging = false;
      savePos(); // ‚úÖ –ø—Ä–æ—Å—Ç–æ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ–∑–∏—Ü—ñ—é, –±–µ–∑ snap
    };

    pip.addEventListener('pointerdown', onPointerDown);
    window.addEventListener('pointermove', onPointerMove);
    window.addEventListener('pointerup', onPointerUp);

    // buttons
    pipPlay.addEventListener('click', (e) => { e.stopPropagation(); togglePlayPause(); });
    pipStop.addEventListener('click', async (e) => {
      e.stopPropagation();
      await stopVideo();
    });

    pipMin.addEventListener('click', (e) => {
      e.stopPropagation();
      setMinimized(true);
    });

    pipLaunch.addEventListener('click', (e) => {
      e.stopPropagation();
      setMinimized(false);

      // –Ω–µ–≤–µ–ª–∏–∫–∏–π ‚Äú–ø—ñ–Ω–≥‚Äù, —â–æ–± –±—É–ª–æ –≤–∏–¥–Ω–æ —â–æ –≤–æ–Ω–æ –ø–æ–≤–µ—Ä–Ω—É–ª–æ—Å—å
      pip.animate([{ transform:'scale(1)' }, { transform:'scale(1.02)' }, { transform:'scale(1)' }], { duration: 220 });
    });

    // convert initial right/top positioning into left/top once
    const r = pip.getBoundingClientRect();
    setPos(r.left, r.top);

    const placeDefault = () => {
      // —è–∫—â–æ –ø–æ–∑–∏—Ü—ñ—è –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–∞ ‚Äî —Å—Ç–∞–≤–∏–º–æ ‚Äú–≤–∏–¥–∏–º–æ‚Äù (–ø—Ä–∞–≤—ñ—à–µ –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É)
      let hasSaved = false;
      try{ hasSaved = !!localStorage.getItem(LS_KEY); }catch(e){}
      if (hasSaved) return;

      const p = getPos();
      const x = Math.round(window.innerWidth * 0.70 - p.w/2);
      const y = Math.round(window.innerHeight * 0.18);
      const maxX = window.innerWidth - p.w - 10;
      const maxY = window.innerHeight - p.h - 10;
      setPos(clamp(x, 10, maxX), clamp(y, 10, maxY));
      savePos();
    };

    // --- HINT LOOP: blink until user touches PiP (per refresh/session) ---
    const TOUCHED_KEY = 'focus_pip_touched_session_v1';

    let hintTimer = 0;

    const hasTouched = () => {
      try { return sessionStorage.getItem(TOUCHED_KEY) === '1'; } catch(e){ return false; }
    };

    const markTouched = () => {
      try { sessionStorage.setItem(TOUCHED_KEY, '1'); } catch(e){}
      pip.classList.add('is-touched');
      stopHintLoop();
    };

    const startHintLoop = () => {
      if (hasTouched()) {
        pip.classList.add('is-touched');
        return;
      }

      const reduceMotion = window.matchMedia &&
        window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      // –ø–µ—Ä—à–∏–π ‚Äú–ø—ñ–Ω–≥‚Äù —á–µ—Ä–µ–∑ 1.5—Å
      const ping = () => {
        if (hasTouched()) return;

        pip.classList.add('is-hinting');
        if (reduceMotion) pip.style.animation = 'none';

        setTimeout(() => {
          pip.classList.remove('is-hinting');
          if (reduceMotion) pip.style.animation = '';
        }, 1200);
      };

      setTimeout(ping, 1500);
      hintTimer = window.setInterval(ping, 4500); // –ø–æ–≤—Ç–æ—Ä –∫–æ–∂–Ω—ñ 4.5—Å, –ø–æ–∫–∏ –Ω–µ —Ç–æ—Ä–∫–Ω—É–ª–∏—Å—å
    };

    const stopHintLoop = () => {
      if (hintTimer) { clearInterval(hintTimer); hintTimer = 0; }
      pip.classList.remove('is-hinting');
    };

    // –ª–æ–≤–∏–º–æ –ü–ï–†–®–£ –±—É–¥—å-—è–∫—É –≤–∑–∞—î–º–æ–¥—ñ—é –∑ PiP (–∫–ª—ñ–∫, —Ç–∞—á, –ø–æ—á–∞—Ç–æ–∫ drag)
    // capture:true —â–æ–± —Å–ø—ñ–π–º–∞—Ç–∏ –Ω–∞–≤—ñ—Ç—å –Ω–∞—Ç–∏—Å–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ
    pip.addEventListener('pointerdown', markTouched, { capture: true, once: true });
    pip.addEventListener('touchstart', markTouched, { capture: true, once: true });
    pip.addEventListener('mousedown', markTouched, { capture: true, once: true });

    restorePos();
    placeDefault();
    startHintLoop();
    restoreMinState();

    // on resize, keep within bounds
    window.addEventListener('resize', () => {
      const p = getPos();
      const maxX = window.innerWidth - p.w - 10;
      const maxY = window.innerHeight - p.h - 10;
      setPos(clamp(p.x, 10, maxX), clamp(p.y, 10, maxY));
      savePos();
    });

    // expose a hook for showSlide()
    window.__pipSetSlide = setSlideContext;

    // init with current active slide
    const active = document.querySelector('.slide.active');
    setSlideContext(active && active.id ? active.id : 'slide1');
  }

  function boot() {
    inject02to10();
    hydratePrototype01StaticPhotos();
    hydrateFullscreenPrototypeImages();
    initCarousels();
    bindNav();

    initFinalPicker();
    initPiPAssistant();

    requestAnimationFrame(() => {
      updateScale();
      showSlide(1);
    });

    // —â–µ —Ä–∞–∑ –ø—ñ—Å–ª—è –ø–æ–≤–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ (—à—Ä–∏—Ñ—Ç–∏/–∫–∞—Ä—Ç–∏–Ω–∫–∏)
    window.addEventListener('load', () => {
      updateScale();
    });

    runSelfTests();
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', boot);
  } else {
    boot();
  }
  </script>
</body>
</html>


